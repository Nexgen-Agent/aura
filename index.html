<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lonz Flawls Aura | Premium Skincare</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <!-- Include Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #e8dcd1;
            --secondary-color: #a8927a;
            --accent-color: #c4a77d;
            --text-dark: #2c2c2c;
            --text-light: #f8f8f8;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
            --admin-bg: #0a1929;
        }

        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-light);
            overflow-x: hidden;
            background: #0a1929;
            overscroll-behavior: none;
        }

        h1, h2, h3, h4, h5 {
            font-family: 'Cormorant Garamond', serif;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        /* Background Video */
        #background-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -2;
            opacity: 0.8;
        }

        .video-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(10, 25, 41, 0.7) 0%, rgba(10, 25, 41, 0.4) 50%, rgba(10, 25, 41, 0.7) 100%);
            z-index: -1;
        }

        /* Floating Shopping Bag - MOVED UP 400px */
        .floating-cart {
            position: fixed;
            left: 50%;
            top: calc(50% - 400px);
            transform: translate(-50%, -50%);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
        }

        .floating-cart-container {
            position: relative;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 50%;
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: var(--transition);
        }

        .floating-cart-container:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.2);
        }

        .floating-cart-container i {
            font-size: 24px;
            color: var(--primary-color);
        }

        .floating-cart-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #dc3545;
            color: white;
            font-size: 12px;
            font-weight: 600;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid rgba(10, 25, 41, 0.9);
        }

        .floating-cart-label {
            font-size: 12px;
            color: var(--text-light);
            background: rgba(10, 25, 41, 0.8);
            padding: 4px 12px;
            border-radius: 15px;
            white-space: nowrap;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
        }

        .floating-cart-container:hover + .floating-cart-label {
            opacity: 1;
            transform: translateY(0);
        }

        /* Glassmorphism */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 16px;
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
            z-index: 10;
        }

        .glass-button {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            color: var(--text-light);
            padding: 12px 28px;
            border-radius: 50px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .glass-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.15);
        }

        /* Social Media Buttons */
        .social-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 20px;
            transition: var(--transition);
            margin: 5px;
            text-decoration: none;
            position: relative;
            z-index: 5;
        }

        .social-button.facebook {
            background: linear-gradient(135deg, #1877F2, #0D5FDB);
            color: white;
        }

        .social-button.tiktok {
            background: linear-gradient(135deg, #000000, #25F4EE, #FE2C55);
            color: white;
        }

        .social-button.whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
        }

        .social-button.email {
            background: linear-gradient(135deg, #EA4335, #D14836);
            color: white;
        }

        .social-button.instagram {
            background: linear-gradient(135deg, #E4405F, #C13584, #833AB4, #5851DB, #405DE6);
            color: white;
        }

        .social-button:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        /* Close Buttons */
        .close-button {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            color: var(--text-light);
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            z-index: 1001;
        }

        .close-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
            color: var(--accent-color);
        }

        /* Navigation - ENLARGED BY 50% (from 80px to 120px) */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            padding: 45px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            transition: var(--transition);
            touch-action: pan-y;
            background: rgba(10, 25, 41, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            height: 120px;
        }

        nav.scrolled {
            background: rgba(10, 25, 41, 0.95);
            backdrop-filter: blur(20px);
            padding: 32px 40px;
            height: 90px;
        }

        .logo {
            font-family: 'Cormorant Garamond', serif;
            font-size: 35.2px;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
            flex-shrink: 0;
            line-height: 1;
        }

        .logo i {
            color: var(--accent-color);
            font-size: 35.2px;
        }

        .nav-links {
            display: flex;
            gap: 32px;
        }

        .nav-links a {
            color: var(--text-light);
            text-decoration: none;
            font-weight: 500;
            font-size: 18.2px;
            transition: var(--transition);
            position: relative;
            padding: 8px 0;
            white-space: nowrap;
        }

        .nav-links a:hover {
            color: var(--primary-color);
        }

        .nav-links a:after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 1px;
            background: var(--primary-color);
            transition: var(--transition);
        }

        .nav-links a:hover:after {
            width: 100%;
        }

        /* Enhanced Search Container - NEW DESIGN */
        .search-container {
            position: relative;
            display: flex;
            align-items: center;
            margin-right: 15px;
        }

        .search-input {
            width: 0;
            opacity: 0;
            padding: 0;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            border-radius: 20px;
            transition: all 0.3s ease;
            position: absolute;
            right: 100%;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16.8px;
            z-index: 1002;
        }

        .search-input.active {
            width: 300px;
            opacity: 1;
            padding: 16.8px 45px 16.8px 20px;
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(10px);
        }

        .search-icon {
            font-size: 30.2px;
            cursor: pointer;
            transition: var(--transition);
            padding: 8px;
            z-index: 2;
        }

        .search-icon:hover {
            color: var(--primary-color);
        }

        .search-close {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            cursor: pointer;
            opacity: 0;
            transition: var(--transition);
            z-index: 3;
            font-size: 16.8px;
            padding: 5px;
        }

        .search-close.active {
            opacity: 1;
        }

        .nav-icons {
            display: flex;
            gap: 15px;
            align-items: center;
            position: relative;
        }

        .nav-icons i {
            font-size: 30.2px;
            cursor: pointer;
            transition: var(--transition);
        }

        .nav-icons i:hover {
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        .mobile-menu-btn {
            display: none;
            font-size: 33.6px;
            cursor: pointer;
            padding: 8px;
            margin-left: 10px;
            transition: var(--transition);
        }

        .mobile-menu-btn.active {
            color: var(--accent-color);
        }

        .mobile-menu-btn.active i {
            transform: rotate(90deg);
        }

        /* Enhanced Search Results - NEW DESIGN */
        .search-results {
            position: absolute;
            top: 100%;
            right: 0;
            width: 400px;
            max-height: 70vh;
            overflow-y: auto;
            background: rgba(10, 25, 41, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            border: 1px solid var(--glass-border);
            box-shadow: var(--shadow);
            display: none;
            z-index: 1001;
            margin-top: 10px;
            padding: 20px;
        }

        .search-results.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        /* Top Searched Products Section */
        .top-searched-section {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .top-searched-section h5 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .top-searched-section h5 i {
            color: var(--accent-color);
        }

        .top-searched-products {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .top-searched-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            transition: var(--transition);
        }

        .top-searched-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .top-searched-item img {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 8px;
        }

        .top-searched-info h6 {
            font-size: 14px;
            color: var(--primary-color);
            margin-bottom: 3px;
        }

        .top-searched-price {
            font-size: 12px;
            color: var(--accent-color);
            font-weight: 600;
        }

        /* Search Suggestions */
        .search-suggestions {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .search-suggestions h5 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .search-suggestions h5 i {
            color: var(--accent-color);
        }

        .suggestions-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .suggestion-tag {
            background: rgba(196, 167, 125, 0.15);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid rgba(196, 167, 125, 0.2);
        }

        .suggestion-tag:hover {
            background: rgba(196, 167, 125, 0.3);
            transform: translateY(-2px);
        }

        /* Search Results Items */
        .search-results-list {
            margin-top: 15px;
        }

        .search-results-list h5 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 14px;
        }

        .search-result-item {
            padding: 15px;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
            border: 1px solid transparent;
        }

        .search-result-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--glass-border);
        }

        .search-result-item img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 10px;
            flex-shrink: 0;
        }

        .search-result-info {
            flex: 1;
            min-width: 0;
        }

        .search-result-info h4 {
            color: var(--primary-color);
            margin-bottom: 5px;
            font-size: 16px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .search-result-info p {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 5px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .search-result-price {
            color: var(--accent-color);
            font-weight: 600;
            font-size: 14px;
        }

        .search-result-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 5px;
        }

        .search-result-tag {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
        }

        .no-results {
            padding: 30px;
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Search categories */
        .search-categories {
            margin-bottom: 15px;
        }

        .search-categories h5 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 14px;
        }

        .category-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .category-tab {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: var(--transition);
        }

        .category-tab.active {
            background: rgba(196, 167, 125, 0.3);
            color: var(--primary-color);
        }

        /* Mobile Menu Overlay */
        .mobile-menu-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .mobile-menu-overlay.active {
            display: block;
            opacity: 1;
        }

        .mobile-nav-links {
            position: fixed;
            top: 0;
            right: 0;
            width: 300px;
            height: 100%;
            background: rgba(10, 25, 41, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            flex-direction: column;
            padding: 150px 30px 30px;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 1000;
            border-left: 1px solid var(--glass-border);
        }

        .mobile-nav-links.active {
            transform: translateX(0);
        }

        .mobile-nav-links a {
            color: var(--text-light);
            text-decoration: none;
            font-size: 18px;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition);
        }

        .mobile-nav-links a:hover {
            color: var(--primary-color);
            padding-left: 10px;
        }

        .mobile-menu-close {
            position: absolute;
            top: 55px;
            right: 25px;
            font-size: 28px;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
            z-index: 1001;
        }

        .mobile-menu-close:hover {
            color: var(--accent-color);
            transform: rotate(90deg);
        }

        /* Full Screen Search Overlay (TikTok Style) */
        .search-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 25, 41, 0.98);
            backdrop-filter: blur(20px);
            z-index: 9999;
            display: none;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .search-overlay.active {
            display: flex;
            opacity: 1;
        }

        .search-header {
            padding: 30px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .search-back-btn {
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 28px;
            cursor: pointer;
            padding: 5px;
        }

        .search-overlay-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            border-radius: 25px;
            padding: 18px 20px;
            color: var(--text-light);
            font-size: 18px;
            outline: none;
        }

        .search-overlay-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .search-overlay-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .search-overlay-results {
            max-width: 800px;
            margin: 0 auto;
        }

        /* Main Content - Adjusted for larger nav */
        .main-content {
            padding-top: 180px;
            position: relative;
            z-index: 1;
        }

        section {
            min-height: 100vh;
            padding: 80px 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            z-index: 2;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding-top: 150px;
        }

        .hero h1 {
            font-size: 4.5rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            line-height: 1.1;
        }

        .hero p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 40px;
            line-height: 1.6;
            color: rgba(255, 255, 255, 0.9);
        }

        .hero-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }

        /* Social Links Section */
        .social-section {
            text-align: center;
            padding: 40px 20px;
            margin-top: 40px;
        }

        .social-section h3 {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 30px;
        }

        .social-links-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }

        /* Lead Qualification Wizard */
        .lead-wizard {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px;
            margin-top: 40px;
            position: relative;
        }

        .wizard-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .wizard-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .wizard-title h3 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        .wizard-title p {
            color: rgba(255, 255, 255, 0.8);
        }

        .wizard-content {
            min-height: 300px;
        }

        .wizard-step {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .wizard-step.active {
            display: block;
        }

        .wizard-step h4 {
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: var(--primary-color);
        }

        .option-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .option-item {
            padding: 18px 15px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border-radius: 12px;
        }

        .option-item:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-5px);
        }

        .option-item.selected {
            background: rgba(196, 167, 125, 0.2);
            border-color: var(--accent-color);
        }

        .option-item i {
            font-size: 28px;
            margin-bottom: 10px;
            color: var(--accent-color);
        }

        .wizard-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }

        .wizard-progress {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            margin-top: 30px;
            overflow: hidden;
        }

        .wizard-progress-bar {
            height: 100%;
            background: var(--accent-color);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Section Headers */
        .section-header {
            text-align: center;
            margin-bottom: 60px;
        }

        .section-header h2 {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .section-header p {
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
        }

        /* Products */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .product-card {
            padding: 25px;
            transition: var(--transition);
            height: 100%;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.15);
        }

        .product-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-recommended {
            background: rgba(40, 167, 69, 0.2);
            color: #28a745;
            border: 1px solid rgba(40, 167, 69, 0.3);
        }

        .badge-bestseller {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .badge-flagship {
            background: rgba(220, 53, 69, 0.2);
            color: #dc3545;
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        .product-image {
            height: 200px;
            width: 100%;
            object-fit: contain;
            background-position: center;
            background-repeat: no-repeat;
            margin-bottom: 20px;
            border-radius: 10px;
        }

        .product-info {
            flex-grow: 1;
        }

        .product-info h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .product-info p {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .product-price {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .product-price span {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.7);
            text-decoration: line-through;
            margin-left: 10px;
        }

        /* Product details */
        .product-details {
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .product-benefits, .product-usage, .product-ingredients {
            margin-bottom: 10px;
        }

        .product-benefits strong, .product-usage strong, .product-ingredients strong {
            color: var(--accent-color);
            display: block;
            margin-bottom: 5px;
        }

        /* Gallery */
        .gallery-container {
            overflow: hidden;
            position: relative;
            padding: 20px 0;
            z-index: 5;
        }

        .gallery-track {
            display: flex;
            gap: 25px;
            padding: 20px;
            transition: transform 0.5s ease;
        }

        .gallery-slide {
            min-width: 300px;
            height: 400px;
            border-radius: 16px;
            overflow: hidden;
            position: relative;
            transition: var(--transition);
        }

        .gallery-slide:hover {
            transform: scale(1.03);
        }

        .gallery-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .gallery-slide:hover img {
            transform: scale(1.1);
        }

        .gallery-nav {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }

        .gallery-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: var(--transition);
        }

        .gallery-dot.active {
            background: var(--accent-color);
            transform: scale(1.2);
        }

        /* Footer */
        footer {
            padding: 60px 40px 30px;
            background: rgba(10, 25, 41, 0.9);
            backdrop-filter: blur(10px);
            margin-top: 60px;
            position: relative;
            z-index: 10;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-column h4 {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .footer-column p {
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-links a:hover {
            color: var(--primary-color);
            padding-left: 5px;
        }

        .newsletter-form {
            display: flex;
            margin-top: 15px;
        }

        .newsletter-form input {
            flex-grow: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 50px 0 0 50px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-light);
        }

        .newsletter-form button {
            border-radius: 0 50px 50px 0;
            padding: 0 25px;
        }

        .copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Scroll Indicator */
        .scroll-indicator {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0) translateX(-50%); }
            40% { transform: translateY(-10px) translateX(-50%); }
            60% { transform: translateY(-5px) translateX(-50%); }
        }

        /* Cart Modal - CLEANER DESIGN */
        .cart-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .cart-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .cart-content {
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 40px;
            position: relative;
        }

        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .cart-header h3 {
            font-size: 2rem;
            color: var(--primary-color);
        }

        .cart-items {
            margin-bottom: 30px;
        }

        /* Cleaner Cart Item Design */
        .cart-item {
            display: grid;
            grid-template-columns: 80px 1fr auto;
            align-items: center;
            padding: 20px;
            margin-bottom: 15px;
            gap: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: var(--transition);
        }

        .cart-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .cart-item-image {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            border: 1px solid var(--glass-border);
        }

        .cart-item-info {
            min-width: 0;
        }

        .cart-item-info h4 {
            font-size: 1.2rem;
            margin-bottom: 8px;
            color: var(--primary-color);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .cart-item-price {
            font-weight: 600;
            color: var(--accent-color);
            font-size: 1.1rem;
            margin-bottom: 10px;
            display: block;
        }

        .cart-item-actions {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 15px;
            min-width: 120px;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: flex-end;
        }

        .quantity-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            color: var(--text-light);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .quantity-btn:hover {
            background: var(--accent-color);
            transform: scale(1.1);
        }

        .quantity {
            min-width: 40px;
            text-align: center;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .remove-item {
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.3);
            color: #ff6b6b;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .remove-item:hover {
            background: rgba(220, 53, 69, 0.3);
            transform: translateY(-2px);
            color: #ff4757;
        }

        .cart-empty {
            text-align: center;
            padding: 60px 40px;
        }

        .cart-empty i {
            font-size: 80px;
            color: rgba(255, 255, 255, 0.2);
            margin-bottom: 20px;
        }

        .cart-empty h4 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .cart-empty p {
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 30px;
        }

        .cart-summary {
            padding: 25px;
            margin-top: 20px;
            border-top: 1px solid var(--glass-border);
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
        }

        .summary-row:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .summary-row.total {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-color);
            padding-top: 15px;
            border-top: 1px solid var(--glass-border);
            margin-top: 10px;
        }

        /* Checkout Modal */
        .checkout-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .checkout-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .checkout-content {
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 40px;
            position: relative;
        }

        .checkout-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .checkout-header h3 {
            font-size: 2rem;
            color: var(--primary-color);
        }

        .checkout-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            position: relative;
        }

        .checkout-steps:before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--glass-border);
            z-index: 1;
        }

        .checkout-step {
            position: relative;
            z-index: 2;
            text-align: center;
            flex: 1;
        }

        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: 600;
            transition: var(--transition);
        }

        .checkout-step.active .step-number {
            background: var(--accent-color);
            border-color: var(--accent-color);
        }

        .checkout-step.completed .step-number {
            background: #28a745;
            border-color: #28a745;
        }

        .step-title {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .checkout-step.active .step-title {
            color: var(--primary-color);
            font-weight: 500;
        }

        .checkout-form {
            display: none;
        }

        .checkout-form.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .checkout-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .payment-method {
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .payment-method:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .payment-method.selected {
            background: rgba(196, 167, 125, 0.2);
            border-color: var(--accent-color);
        }

        .payment-method i {
            font-size: 32px;
            margin-bottom: 10px;
            color: var(--accent-color);
        }

        .checkout-review {
            padding: 20px;
            margin-bottom: 30px;
        }

        .review-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--glass-border);
        }

        /* Success Modal - FIXED BUTTON SPACING */
        .success-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .success-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .success-content {
            width: 90%;
            max-width: 500px;
            padding: 40px;
            text-align: center;
            position: relative;
        }

        .success-icon {
            font-size: 80px;
            color: #28a745;
            margin-bottom: 30px;
            animation: bounce 2s infinite;
        }

        .success-message h3 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        .success-message p {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 30px;
            color: rgba(255, 255, 255, 0.9);
        }

        /* Success Modal Button Container - FIXED SPACING */
        .success-button-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 40px;
            width: 100%;
        }

        .success-button-container .glass-button {
            flex: 1;
            min-width: 200px;
            max-width: 250px;
            margin: 0 !important;
        }

        /* Results Modal - UPDATED LAYOUT */
        .results-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            padding: 120px 20px 40px;
            overflow-y: auto;
        }

        .results-modal.active {
            opacity: 1;
            visibility: visible;
        }

        /* Affirmations Section - FREE STANDING LIKE HERO */
        .affirmations-section {
            text-align: center;
            width: 100%;
            max-width: 900px;
            margin-bottom: 40px;
            position: relative;
            z-index: 10;
        }

        .affirmations-section .result-icon {
            font-size: 60px;
            color: var(--accent-color);
            margin-bottom: 20px;
        }

        .affirmations-section .result-message {
            text-align: center;
        }

        .affirmations-section .result-message h3 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .affirmations-section .result-message p {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 30px;
            color: rgba(255, 255, 255, 0.9);
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Results Products Section - NOW IN GLASS CARD */
        .results-products-section {
            width: 100%;
            max-width: 1200px;
            position: relative;
            z-index: 10;
        }

        .results-products-container {
            padding: 40px;
            position: relative;
        }

        /* Close button for results modal */
        .results-modal .close-button {
            position: fixed;
            top: 140px;
            right: 40px;
            z-index: 2001;
        }

        /* Personalized Products Container - NOW USING PRODUCT CARD STYLE */
        .personalized-products-container {
            margin-top: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        /* Product cards in personalized recommendations - SAME AS ALL PRODUCTS SECTION */
        .personalized-products-container .product-card {
            padding: 25px;
            transition: var(--transition);
            height: 100%;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .personalized-products-container .product-card:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.15);
        }

        .personalized-products-container .product-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .personalized-products-container .product-image {
            height: 200px;
            width: 100%;
            object-fit: contain;
            background-position: center;
            background-repeat: no-repeat;
            margin-bottom: 20px;
            border-radius: 10px;
        }

        .personalized-products-container .product-info {
            flex-grow: 1;
        }

        .personalized-products-container .product-info h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .personalized-products-container .product-info p {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .personalized-products-container .product-price {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .personalized-products-container .product-details {
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .personalized-products-container .product-benefits,
        .personalized-products-container .product-usage,
        .personalized-products-container .product-ingredients {
            margin-bottom: 10px;
        }

        .personalized-products-container .product-benefits strong,
        .personalized-products-container .product-usage strong,
        .personalized-products-container .product-ingredients strong {
            color: var(--accent-color);
            display: block;
            margin-bottom: 5px;
        }

        /* Special combo card styling */
        .personalized-products-container .product-card.combo-card {
            border: 2px solid var(--accent-color);
            background: rgba(196, 167, 125, 0.1);
        }

        .personalized-products-container .product-card.combo-card .product-badge {
            background: rgba(40, 167, 69, 0.3);
            color: #28a745;
            border: 1px solid rgba(40, 167, 69, 0.5);
        }

        .result-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Authentication Modal */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .auth-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .auth-content {
            width: 90%;
            max-width: 500px;
            padding: 40px;
            text-align: center;
            position: relative;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 1px solid var(--glass-border);
        }

        .auth-tab {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 2px solid transparent;
        }

        .auth-tab.active {
            color: var(--primary-color);
            border-bottom: 2px solid var(--accent-color);
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 14px 18px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            color: var(--text-light);
            font-size: 16px;
            transition: var(--transition);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-color);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 20px rgba(196, 167, 125, 0.2);
        }

        .form-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .form-checkbox input {
            width: 18px;
            height: 18px;
        }

        .form-checkbox label {
            margin-bottom: 0;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .forgot-password {
            display: block;
            text-align: right;
            margin-top: 5px;
            color: var(--accent-color);
            text-decoration: none;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .forgot-password:hover {
            text-decoration: underline;
        }

        .auth-footer {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid var(--glass-border);
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .auth-footer a {
            color: var(--accent-color);
            text-decoration: none;
            transition: var(--transition);
        }

        .auth-footer a:hover {
            text-decoration: underline;
        }

        /* FLAGSHIP PRODUCT SPECIFIC STYLES */
        .flagship-card {
            grid-column: span 2 !important;
        }

        .flagship-container {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }

        .flagship-image {
            flex: 1;
            height: 300px;
            object-fit: contain;
            border-radius: 10px;
            min-width: 0;
        }

        .flagship-info {
            flex: 1;
            min-width: 0;
        }

        .flagship-details {
            margin-top: 15px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .flagship-details.collapsed {
            max-height: 80px;
        }

        .flagship-details.expanded {
            max-height: 500px;
        }

        .see-more-btn {
            background: transparent;
            border: none;
            color: var(--accent-color);
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
            padding: 5px 10px;
            border-radius: 4px;
            transition: var(--transition);
        }

        .see-more-btn:hover {
            background: rgba(196, 167, 125, 0.1);
        }

        /* Address Selection Styles - NEW */
        .address-selection-container {
            margin-bottom: 20px;
        }

        .address-step {
            margin-bottom: 20px;
            display: none;
        }

        .address-step.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .address-progress {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--glass-border);
        }

        .address-progress-step {
            display: flex;
            align-items: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 14px;
        }

        .address-progress-step.active {
            color: var(--primary-color);
        }

        .address-progress-step.completed {
            color: var(--accent-color);
        }

        .address-progress-step .step-number {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
            font-size: 12px;
        }

        .address-progress-step.active .step-number {
            background: var(--accent-color);
            border-color: var(--accent-color);
        }

        .address-progress-step.completed .step-number {
            background: #28a745;
            border-color: #28a745;
        }

        .address-progress-separator {
            width: 30px;
            height: 1px;
            background: rgba(255, 255, 255, 0.2);
            margin: 0 10px;
        }

        .address-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .address-option {
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .address-option:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-3px);
        }

        .address-option.selected {
            background: rgba(196, 167, 125, 0.2);
            border-color: var(--accent-color);
        }

        .address-option i {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--accent-color);
        }

        .address-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        .address-confirmation {
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin-top: 20px;
        }

        .address-confirmation h5 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 16px;
        }

        .address-details {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            line-height: 1.6;
        }

        /* Google Maps Integration */
        .google-maps-container {
            height: 200px;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
            position: relative;
        }

        .google-maps-placeholder {
            height: 100%;
            background: rgba(255, 255, 255, 0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.6);
        }

        .google-maps-placeholder i {
            font-size: 40px;
            margin-bottom: 15px;
            color: var(--accent-color);
        }

        .google-maps-placeholder p {
            font-size: 14px;
            max-width: 300px;
            text-align: center;
        }

        .address-search {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .address-search-input {
            flex: 1;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: var(--text-light);
        }

        .address-search-input:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        /* ZIP Code Validation */
        .zip-validation {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            font-size: 14px;
        }

        .zip-validation.valid {
            color: #28a745;
        }

        .zip-validation.invalid {
            color: #dc3545;
        }

        /* Manual Village Entry */
        .manual-village-container {
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
        }

        .manual-village-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .manual-village-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .manual-village-header i {
            color: var(--accent-color);
            font-size: 20px;
        }

        .manual-village-header h5 {
            color: var(--primary-color);
            margin: 0;
            font-size: 16px;
        }

        .manual-village-fields {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .manual-village-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Global Shipping Option */
        .global-shipping-note {
            padding: 15px;
            background: rgba(40, 167, 69, 0.1);
            border: 1px solid rgba(40, 167, 69, 0.2);
            border-radius: 10px;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .global-shipping-note p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .global-shipping-note i {
            color: #28a745;
        }

        /* Payment Form Sections - NEW STYLES */
        .payment-form-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .payment-form-section.active {
            display: block;
        }

        .payment-instructions {
            padding: 25px;
            margin-bottom: 25px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
        }

        .payment-instructions h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .payment-instructions p {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .payment-instructions ul {
            margin-left: 20px;
            margin-bottom: 20px;
            color: rgba(255, 255, 255, 0.8);
        }

        .payment-instructions li {
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .bank-details {
            margin-top: 25px;
            padding: 20px;
            background: rgba(40, 167, 69, 0.1);
            border: 1px solid rgba(40, 167, 69, 0.2);
            border-radius: 10px;
        }

        .bank-details h5 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .bank-detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .bank-detail-row:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .bank-detail-label {
            color: rgba(255, 255, 255, 0.7);
            font-weight: 500;
        }

        .bank-detail-value {
            color: var(--accent-color);
            font-weight: 600;
            text-align: right;
        }

        .copy-button {
            background: rgba(196, 167, 125, 0.2);
            border: 1px solid rgba(196, 167, 125, 0.3);
            color: var(--primary-color);
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: var(--transition);
            margin-left: 10px;
        }

        .copy-button:hover {
            background: rgba(196, 167, 125, 0.3);
            transform: translateY(-2px);
        }

        .reference-note {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.2);
            border-radius: 8px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
        }

        .reference-note strong {
            color: var(--accent-color);
        }

        .paypal-button-container {
            text-align: center;
            margin: 30px 0;
        }

        .paypal-button {
            background: linear-gradient(135deg, #003087, #009cde);
            color: white;
            border: none;
            padding: 16px 40px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 8px 20px rgba(0, 48, 135, 0.3);
        }

        .paypal-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(0, 48, 135, 0.4);
            background: linear-gradient(135deg, #003087, #0070ba);
        }

        .paypal-button i {
            font-size: 1.4rem;
        }

        .paypal-note {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 48, 135, 0.1);
            border: 1px solid rgba(0, 48, 135, 0.2);
            border-radius: 8px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            text-align: center;
        }

        /* ============ ADMIN PANEL STYLES ============ */
        
        /* Admin Button in Nav */
        .admin-nav-btn {
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.3);
            color: #ff6b6b;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            margin-right: 10px;
        }

        .admin-nav-btn:hover {
            background: rgba(220, 53, 69, 0.3);
            transform: translateY(-2px);
            color: #ff4757;
        }

        /* Admin Modal */
        .admin-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .admin-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .admin-content {
            width: 95%;
            max-width: 1400px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 40px;
            position: relative;
            background: var(--admin-bg);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-header h3 {
            font-size: 2.5rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .admin-header h3 i {
            color: var(--accent-color);
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .admin-stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-stat-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--accent-color);
        }

        .admin-stat-card i {
            font-size: 40px;
            margin-bottom: 15px;
            color: var(--accent-color);
        }

        .admin-stat-card h4 {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .admin-stat-card p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .admin-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-wrap: wrap;
            gap: 10px;
        }

        .admin-tab {
            padding: 15px 25px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 2px solid transparent;
            position: relative;
        }

        .admin-tab.active {
            color: var(--primary-color);
            border-bottom: 2px solid var(--accent-color);
            background: rgba(196, 167, 125, 0.1);
        }

        .admin-tab:hover {
            color: var(--primary-color);
            background: rgba(255, 255, 255, 0.05);
        }

        .admin-tab-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--danger-color);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 20px;
            text-align: center;
        }

        .admin-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .admin-section.active {
            display: block;
        }

        /* Admin Table Styles */
        .admin-table-container {
            overflow-x: auto;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.02);
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        .admin-table th {
            background: rgba(255, 255, 255, 0.05);
            padding: 18px 15px;
            text-align: left;
            color: var(--primary-color);
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
        }

        .admin-table tr:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        .admin-table tr:last-child td {
            border-bottom: none;
        }

        /* Status Badges */
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-pending {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .status-processing {
            background: rgba(0, 123, 255, 0.2);
            color: #007bff;
            border: 1px solid rgba(0, 123, 255, 0.3);
        }

        .status-completed {
            background: rgba(40, 167, 69, 0.2);
            color: #28a745;
            border: 1px solid rgba(40, 167, 69, 0.3);
        }

        .status-cancelled {
            background: rgba(220, 53, 69, 0.2);
            color: #dc3545;
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        /* Admin Form */
        .admin-form {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-form-header h4 {
            color: var(--primary-color);
            font-size: 1.5rem;
        }

        .admin-form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .admin-form-group {
            margin-bottom: 20px;
        }

        .admin-form-group label {
            display: block;
            margin-bottom: 8px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
            font-size: 14px;
        }

        .admin-form-group input,
        .admin-form-group textarea,
        .admin-form-group select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-light);
            font-size: 14px;
            transition: var(--transition);
        }

        .admin-form-group input:focus,
        .admin-form-group textarea:focus,
        .admin-form-group select:focus {
            outline: none;
            border-color: var(--accent-color);
            background: rgba(255, 255, 255, 0.08);
        }

        .admin-form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Admin Actions */
        .admin-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .admin-action-btn {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .admin-action-btn.edit {
            background: rgba(0, 123, 255, 0.2);
            color: #007bff;
            border: 1px solid rgba(0, 123, 255, 0.3);
        }

        .admin-action-btn.edit:hover {
            background: rgba(0, 123, 255, 0.3);
            transform: translateY(-2px);
        }

        .admin-action-btn.delete {
            background: rgba(220, 53, 69, 0.2);
            color: #dc3545;
            border: 1px solid rgba(220, 53, 69, 0.3);
        }

        .admin-action-btn.delete:hover {
            background: rgba(220, 53, 69, 0.3);
            transform: translateY(-2px);
        }

        .admin-action-btn.view {
            background: rgba(40, 167, 69, 0.2);
            color: #28a745;
            border: 1px solid rgba(40, 167, 69, 0.3);
        }

        .admin-action-btn.view:hover {
            background: rgba(40, 167, 69, 0.3);
            transform: translateY(-2px);
        }

        .admin-action-btn.update {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .admin-action-btn.update:hover {
            background: rgba(255, 193, 7, 0.3);
            transform: translateY(-2px);
        }

        /* Admin Search and Filter */
        .admin-search-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .admin-search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }

        .admin-search-box input {
            width: 100%;
            padding: 12px 45px 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-light);
            font-size: 14px;
        }

        .admin-search-box i {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.5);
        }

        .admin-filter-select {
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-light);
            font-size: 14px;
            min-width: 150px;
        }

        /* Admin Pagination */
        .admin-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-page-btn {
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            transition: var(--transition);
            font-size: 14px;
        }

        .admin-page-btn.active {
            background: rgba(196, 167, 125, 0.2);
            color: var(--primary-color);
            border-color: var(--accent-color);
        }

        .admin-page-btn:hover:not(.disabled) {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .admin-page-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Admin Charts */
        .admin-chart-container {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }

        .admin-chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .admin-chart-header h5 {
            color: var(--primary-color);
            font-size: 1.2rem;
        }

        .admin-chart {
            height: 300px;
            position: relative;
        }

        /* Admin Notifications */
        .admin-notifications {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 4000;
            max-width: 400px;
        }

        .admin-notification {
            background: var(--admin-bg);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid var(--accent-color);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideInRight 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .admin-notification i {
            font-size: 20px;
            color: var(--accent-color);
        }

        .admin-notification-content {
            flex: 1;
        }

        .admin-notification-content h6 {
            color: var(--primary-color);
            margin-bottom: 5px;
            font-size: 14px;
        }

        .admin-notification-content p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 13px;
            line-height: 1.4;
        }

        .admin-notification-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            padding: 5px;
            font-size: 12px;
            transition: var(--transition);
        }

        .admin-notification-close:hover {
            color: var(--danger-color);
        }

        /* Admin Loading */
        .admin-loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 50px;
            color: rgba(255, 255, 255, 0.5);
            flex-direction: column;
            gap: 15px;
        }

        .admin-loading i {
            font-size: 40px;
            color: var(--accent-color);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Admin Empty State */
        .admin-empty-state {
            text-align: center;
            padding: 50px;
            color: rgba(255, 255, 255, 0.5);
        }

        .admin-empty-state i {
            font-size: 60px;
            margin-bottom: 20px;
            color: rgba(255, 255, 255, 0.2);
        }

        .admin-empty-state h5 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .admin-empty-state p {
            font-size: 14px;
            max-width: 400px;
            margin: 0 auto 20px;
        }

        /* Responsive Admin */
        @media (max-width: 1100px) {
            .nav-links {
                gap: 24px;
            }
            
            .logo {
                font-size: 32px;
            }
            
            .search-input.active {
                width: 280px;
            }
            
            .address-options {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .manual-village-fields {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .hero h1 {
                font-size: 3.5rem;
            }
            
            .section-header h2 {
                font-size: 2.5rem;
            }
            
            .option-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .search-input.active {
                width: 240px;
            }
            
            .search-results {
                width: 350px;
            }
            
            .nav-links a {
                padding: 10px 0;
            }
            
            .glass-button {
                padding: 15px 30px;
                min-height: 50px;
            }
            
            .nav-icons {
                gap: 15px;
            }
            
            .flagship-card {
                grid-column: span 1 !important;
            }
            
            .flagship-container {
                flex-direction: column;
                gap: 20px;
            }
            
            .flagship-image {
                height: 200px;
                width: 100%;
            }
            
            .flagship-details.collapsed {
                max-height: 60px;
            }
            
            .address-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 850px) {
            .nav-links {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .logo {
                font-size: 28px;
            }
            
            .search-input.active {
                width: 220px;
            }
            
            nav {
                padding: 38px 20px;
                height: 105px;
            }
            
            nav.scrolled {
                padding: 28px 20px;
                height: 75px;
            }
            
            .flagship-card {
                grid-column: span 1 !important;
            }
            
            .flagship-container {
                flex-direction: column;
                gap: 20px;
            }
            
            .flagship-image {
                height: 200px;
                width: 100%;
            }
            
            .flagship-details.collapsed {
                max-height: 60px;
            }
            
            .personalized-products-container {
                grid-template-columns: 1fr;
            }
            
            .affirmations-section .result-message h3 {
                font-size: 1.8rem;
            }
            
            .affirmations-section .result-message p {
                font-size: 1rem;
            }
            
            .results-modal .close-button {
                top: 120px;
                right: 20px;
            }
            
            .address-options {
                grid-template-columns: 1fr;
            }
            
            .address-progress {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .address-progress-separator {
                display: none;
            }
            
            .manual-village-fields {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            nav {
                padding: 38px 20px;
                height: 105px;
            }
            
            nav.scrolled {
                padding: 28px 20px;
                height: 75px;
            }
            
            .logo {
                font-size: 24px;
            }
            
            .search-input.active {
                display: none;
            }
            
            .search-results {
                display: none !important;
            }
            
            section {
                padding: 80px 20px;
            }
            
            .hero h1 {
                font-size: 2.8rem;
            }
            
            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .glass-button {
                width: 100%;
                max-width: 300px;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
            }
            
            .gallery-slide {
                min-width: 250px;
                height: 350px;
            }
            
            .lead-wizard {
                padding: 25px;
            }
            
            .gallery-slide, .option-item, .product-card {
                touch-action: pan-y;
            }
            
            .nav-icons {
                gap: 12px;
            }
            
            .mobile-menu-btn {
                margin-left: 8px;
                font-size: 28px;
            }
            
            .floating-cart {
                left: auto;
                right: 20px;
                top: auto;
                bottom: 20px;
                transform: none;
            }
            
            .floating-cart-container {
                width: 50px;
                height: 50px;
            }
            
            .floating-cart-container i {
                font-size: 20px;
            }
            
            .floating-cart-label {
                display: none;
            }
            
            .main-content {
                padding-top: 135px;
            }
            
            .cart-item {
                grid-template-columns: 60px 1fr;
                gap: 15px;
                padding: 15px;
            }
            
            .cart-item-image {
                width: 60px;
                height: 60px;
            }
            
            .cart-item-actions {
                grid-column: span 2;
                flex-direction: row;
                justify-content: space-between;
                width: 100%;
                min-width: auto;
            }
            
            .remove-item {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
            
            .results-modal {
                padding: 100px 10px 20px;
            }
            
            .affirmations-section .result-icon {
                font-size: 50px;
            }
            
            .affirmations-section .result-message h3 {
                font-size: 1.6rem;
            }
            
            .affirmations-section .result-message p {
                font-size: 0.95rem;
            }
            
            .results-products-container {
                padding: 20px;
            }
            
            .personalized-products-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .result-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .result-actions .glass-button {
                width: 100%;
                max-width: 300px;
                margin-left: 0 !important;
                margin-bottom: 10px;
            }
            
            .success-button-container {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .success-button-container .glass-button {
                width: 100%;
                max-width: 300px;
                margin-left: 0 !important;
                margin-bottom: 0;
            }
            
            .results-modal .close-button {
                top: 110px;
                right: 15px;
                width: 35px;
                height: 35px;
                font-size: 18px;
            }
            
            .address-navigation {
                flex-direction: column;
                gap: 15px;
            }
            
            .address-navigation .glass-button {
                width: 100%;
            }
            
            .manual-village-actions {
                flex-direction: column;
            }
            
            .manual-village-actions .glass-button {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .logo {
                font-size: 20px;
            }
            
            .nav-icons {
                gap: 8px;
            }
            
            .search-results {
                padding: 15px;
            }
            
            .top-searched-item {
                padding: 8px;
            }
            
            .top-searched-item img {
                width: 40px;
                height: 40px;
            }
            
            .suggestion-tag {
                font-size: 11px;
                padding: 5px 10px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            nav {
                padding: 35px 15px;
                height: 100px;
            }
            
            nav.scrolled {
                padding: 25px 15px;
                height: 70px;
            }
            
            .flagship-image {
                height: 180px;
            }
            
            .success-button-container {
                gap: 12px;
            }
            
            .success-button-container .glass-button {
                min-width: 100%;
                max-width: 100%;
                padding: 14px 20px;
            }
            
            .affirmations-section .result-message h3 {
                font-size: 1.4rem;
            }
            
            .affirmations-section .result-message p {
                font-size: 0.9rem;
            }
            
            .results-products-container {
                padding: 15px;
            }
            
            .address-progress-step {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- Floating Cart - MOVED UP 400px -->
    <div class="floating-cart" id="floatingCart">
        <div class="floating-cart-container" id="floatingCartBtn">
            <i class="fas fa-shopping-bag"></i>
            <div class="floating-cart-badge" id="floatingCartBadge">0</div>
        </div>
        <div class="floating-cart-label">Your Bag</div>
    </div>

    <!-- Background Video -->
    <video autoplay muted loop id="background-video">
        <source src="https://assets.mixkit.co/videos/preview/mixkit-ripples-on-the-surface-of-a-lake-4099-large.mp4" type="video/mp4">
    </video>
    <div class="video-overlay"></div>

    <!-- Search Overlay (TikTok Style) -->
    <div class="search-overlay" id="searchOverlay">
        <div class="search-header">
            <button class="search-back-btn" id="searchBackBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            <input type="text" class="search-overlay-input" id="searchOverlayInput" placeholder="Search products or skin issues...">
        </div>
        <div class="search-overlay-content">
            <div class="search-overlay-results" id="searchOverlayResults">
                <!-- Content will be populated dynamically -->
            </div>
        </div>
    </div>

    <!-- Authentication Modal -->
    <div class="auth-modal" id="authModal">
        <div class="auth-content glass-card">
            <button class="close-button" id="closeAuth">&times;</button>
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">Login</button>
                <button class="auth-tab" data-tab="signup">Sign Up</button>
            </div>
            
            <!-- Login Form -->
            <form class="auth-form active" id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">Email Address</label>
                    <input type="email" id="loginEmail" class="form-input" placeholder="Enter your email" required>
                </div>
                
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" class="form-input" placeholder="Enter your password" required>
                    <a href="#" class="forgot-password">Forgot Password?</a>
                </div>
                
                <div class="form-checkbox">
                    <input type="checkbox" id="rememberMe">
                    <label for="rememberMe">Remember me</label>
                </div>
                
                <button type="submit" class="glass-button" style="width: 100%;">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
                
                <div class="auth-footer">
                    Don't have an account? <a href="#" class="switch-to-signup">Sign up here</a>
                </div>
            </form>
            
            <!-- Sign Up Form -->
            <form class="auth-form" id="signupForm">
                <div class="form-group">
                    <label for="signupName">Full Name</label>
                    <input type="text" id="signupName" class="form-input" placeholder="Enter your full name" required>
                </div>
                
                <div class="form-group">
                    <label for="signupEmail">Email Address</label>
                    <input type="email" id="signupEmail" class="form-input" placeholder="Enter your email" required>
                </div>
                
                <div class="form-group">
                    <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" class="form-input" placeholder="Create a password" required>
                </div>
                
                <div class="form-group">
                    <label for="signupConfirmPassword">Confirm Password</label>
                    <input type="password" id="signupConfirmPassword" class="form-input" placeholder="Confirm your password" required>
                </div>
                
                <div class="form-checkbox">
                    <input type="checkbox" id="agreeTerms" required>
                    <label for="agreeTerms">I agree to the Terms & Conditions and Privacy Policy</label>
                </div>
                
                <button type="submit" class="glass-button" style="width: 100%;">
                    <i class="fas fa-user-plus"></i> Create Account
                </button>
                
                <div class="auth-footer">
                    Already have an account? <a href="#" class="switch-to-login">Login here</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Cart Modal - CLEANER DESIGN -->
    <div class="cart-modal" id="cartModal">
        <div class="cart-content glass-card">
            <button class="close-button" id="closeCart">&times;</button>
            <div class="cart-header">
                <h3>Your Shopping Bag</h3>
            </div>
            
            <div class="cart-items" id="cartItems">
                <div class="cart-empty">
                    <i class="fas fa-shopping-bag"></i>
                    <h4>Your bag is empty</h4>
                    <p>Add some products to get started!</p>
                    <button class="glass-button" onclick="document.querySelector('#all-products').scrollIntoView({behavior: 'smooth'})">
                        <i class="fas fa-store"></i> Browse Products
                    </button>
                </div>
            </div>
            
            <div class="cart-summary glass-card" id="cartSummary" style="display: none;">
                <div class="summary-row">
                    <span>Subtotal</span>
                    <span id="cartSubtotal">R0.00</span>
                </div>
                <div class="summary-row">
                    <span>Shipping</span>
                    <span id="cartShipping">R50.00</span>
                </div>
                <div class="summary-row">
                    <span>Tax</span>
                    <span id="cartTax">R0.00</span>
                </div>
                <div class="summary-row total">
                    <span>Total</span>
                    <span id="cartTotal">R0.00</span>
                </div>
                
                <button class="glass-button" style="width: 100%; margin-top: 20px;" id="checkoutBtn">
                    <i class="fas fa-lock"></i> Proceed to Checkout
                </button>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div class="checkout-modal" id="checkoutModal">
        <div class="checkout-content glass-card">
            <button class="close-button" id="closeCheckout">&times;</button>
            <div class="checkout-header">
                <h3>Checkout</h3>
            </div>
            
            <div class="checkout-steps">
                <div class="checkout-step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-title">Shipping</div>
                </div>
                <div class="checkout-step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-title">Payment</div>
                </div>
                <div class="checkout-step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-title">Review</div>
                </div>
            </div>
            
            <!-- Step 1: Shipping - UPDATED WITH NEW ADDRESS SELECTION SYSTEM -->
            <form class="checkout-form active" id="shippingForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="shippingFirstName">First Name</label>
                        <input type="text" id="shippingFirstName" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="shippingLastName">Last Name</label>
                        <input type="text" id="shippingLastName" class="form-input" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="shippingEmail">Email Address</label>
                    <input type="email" id="shippingEmail" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label for="shippingPhone">Phone Number</label>
                    <input type="tel" id="shippingPhone" class="form-input" required>
                </div>
                
                <!-- Global Shipping Note -->
                <div class="global-shipping-note">
                    <p><i class="fas fa-globe-americas"></i> We ship worldwide! Don't see your village? You can enter it manually below.</p>
                </div>
                
                <!-- NEW ADDRESS SELECTION SYSTEM WITH MANUAL ENTRY -->
                <div class="address-selection-container">
                    <div class="address-progress">
                        <div class="address-progress-step active" data-step="country">
                            <div class="step-number">1</div>
                            Country
                        </div>
                        <div class="address-progress-separator"></div>
                        <div class="address-progress-step" data-step="state">
                            <div class="step-number">2</div>
                            State/Province
                        </div>
                        <div class="address-progress-separator"></div>
                        <div class="address-progress-step" data-step="city">
                            <div class="step-number">3</div>
                            City/Town
                        </div>
                        <div class="address-progress-separator"></div>
                        <div class="address-progress-step" data-step="village">
                            <div class="step-number">4</div>
                            Village/Suburb
                        </div>
                        <div class="address-progress-separator"></div>
                        <div class="address-progress-step" data-step="zip">
                            <div class="step-number">5</div>
                            ZIP Code
                        </div>
                    </div>
                    
                    <!-- Country Selection -->
                    <div class="address-step active" id="countryStep">
                        <h4 style="color: var(--primary-color); margin-bottom: 20px;">Select Your Country</h4>
                        <div class="address-options" id="countryOptions">
                            <!-- Country options will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- State/Province Selection -->
                    <div class="address-step" id="stateStep">
                        <h4 style="color: var(--primary-color); margin-bottom: 20px;">Select Your State/Province</h4>
                        <div class="address-search">
                            <input type="text" class="address-search-input" id="stateSearch" placeholder="Search for your state/province...">
                            <button type="button" class="glass-button" style="padding: 12px 20px;" onclick="searchStates()">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        <div class="address-options" id="stateOptions">
                            <!-- State options will be populated by JavaScript -->
                        </div>
                        <div class="address-options" style="margin-top: 15px;">
                            <div class="address-option" onclick="enterStateManually()">
                                <i class="fas fa-edit"></i>
                                <p>Enter State Manually</p>
                                <small style="color: rgba(255, 255, 255, 0.6);">Can't find your state?</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- City/Town Selection -->
                    <div class="address-step" id="cityStep">
                        <h4 style="color: var(--primary-color); margin-bottom: 20px;">Select Your City/Town</h4>
                        <div class="address-search">
                            <input type="text" class="address-search-input" id="citySearch" placeholder="Search for your city/town...">
                            <button type="button" class="glass-button" style="padding: 12px 20px;" onclick="searchCities()">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        <div class="address-options" id="cityOptions">
                            <!-- City options will be populated by JavaScript -->
                        </div>
                        <div class="address-options" style="margin-top: 15px;">
                            <div class="address-option" onclick="enterCityManually()">
                                <i class="fas fa-edit"></i>
                                <p>Enter City Manually</p>
                                <small style="color: rgba(255, 255, 255, 0.6);">Can't find your city?</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Village/Suburb Selection -->
                    <div class="address-step" id="villageStep">
                        <h4 style="color: var(--primary-color); margin-bottom: 20px;">Select Your Village/Suburb</h4>
                        <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 15px; font-size: 14px;">Select your village or suburb for precise delivery. Can't find yours? Enter it manually below.</p>
                        <div class="address-search">
                            <input type="text" class="address-search-input" id="villageSearch" placeholder="Search for your village/suburb...">
                            <button type="button" class="glass-button" style="padding: 12px 20px;" onclick="searchVillages()">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                        <div class="address-options" id="villageOptions">
                            <!-- Village options will be populated by JavaScript -->
                        </div>
                        
                        <!-- Manual Village Entry -->
                        <div class="manual-village-container" id="manualVillageContainer">
                            <div class="manual-village-header">
                                <i class="fas fa-map-pin"></i>
                                <h5>Enter Village/Suburb Details Manually</h5>
                            </div>
                            <div class="manual-village-fields">
                                <div class="form-group">
                                    <label for="manualVillageName">Village/Suburb Name</label>
                                    <input type="text" id="manualVillageName" class="form-input" placeholder="Enter village or suburb name">
                                </div>
                                <div class="form-group">
                                    <label for="manualVillageZip">ZIP/Postal Code</label>
                                    <input type="text" id="manualVillageZip" class="form-input" placeholder="Enter ZIP code">
                                </div>
                            </div>
                            <div class="manual-village-actions">
                                <button type="button" class="glass-button" onclick="cancelManualVillage()">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                                <button type="button" class="glass-button" onclick="saveManualVillage()" style="background: rgba(196, 167, 125, 0.3);">
                                    <i class="fas fa-save"></i> Save & Continue
                                </button>
                            </div>
                        </div>
                        
                        <div class="address-options" style="margin-top: 15px;">
                            <div class="address-option" onclick="skipVillage()">
                                <i class="fas fa-forward"></i>
                                <p>Skip Village/Suburb</p>
                                <small style="color: rgba(255, 255, 255, 0.6);">I don't have a village/suburb</small>
                            </div>
                            <div class="address-option" onclick="enterVillageManually()">
                                <i class="fas fa-edit"></i>
                                <p>Enter Village Manually</p>
                                <small style="color: rgba(255, 255, 255, 0.6);">My village is not listed</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ZIP Code Entry -->
                    <div class="address-step" id="zipStep">
                        <h4 style="color: var(--primary-color); margin-bottom: 20px;">Enter Your ZIP/Postal Code</h4>
                        <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 20px; font-size: 14px;">Enter your ZIP code for accurate shipping calculation</p>
                        
                        <div class="form-group">
                            <label for="shippingZip">ZIP/Postal Code</label>
                            <input type="text" id="shippingZip" class="form-input" placeholder="Enter ZIP code" required>
                            <div class="zip-validation" id="zipValidation">
                                <!-- Validation message will appear here -->
                            </div>
                        </div>
                        
                        <!-- Note for manual village entry -->
                        <div id="manualVillageNote" style="display: none;">
                            <div class="global-shipping-note">
                                <p><i class="fas fa-info-circle"></i> Using manually entered village and ZIP code. Shipping will be calculated based on this information.</p>
                            </div>
                        </div>
                        
                        <!-- Google Maps Integration -->
                        <div class="google-maps-container">
                            <div class="google-maps-placeholder">
                                <i class="fas fa-map-marked-alt"></i>
                                <p>Google Maps integration for address verification</p>
                                <small style="margin-top: 10px;">Your address will be verified for shipping accuracy</small>
                            </div>
                        </div>
                        
                        <!-- Address Confirmation -->
                        <div class="address-confirmation" id="addressConfirmation">
                            <h5>Selected Address</h5>
                            <div class="address-details" id="addressDetails">
                                <!-- Address details will appear here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Address Navigation -->
                    <div class="address-navigation">
                        <button type="button" class="glass-button" id="prevAddressStep" style="display: none;">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button type="button" class="glass-button" id="nextAddressStep">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Street Address -->
                <div class="form-group">
                    <label for="shippingAddress">Street Address</label>
                    <input type="text" id="shippingAddress" class="form-input" placeholder="House number, street name, building" required>
                </div>
                
                <!-- Apartment/Suite (Optional) -->
                <div class="form-group">
                    <label for="shippingApartment">Apartment, Suite, Unit (Optional)</label>
                    <input type="text" id="shippingApartment" class="form-input" placeholder="Apartment, suite, unit, etc.">
                </div>
                
                <!-- Additional Notes -->
                <div class="form-group">
                    <label for="shippingNotes">Delivery Instructions (Optional)</label>
                    <textarea id="shippingNotes" class="form-input" rows="3" placeholder="Any special delivery instructions?"></textarea>
                </div>
                
                <div class="checkout-actions">
                    <button type="button" class="glass-button" id="backToCart">
                        <i class="fas fa-arrow-left"></i> Back to Cart
                    </button>
                    <button type="button" class="glass-button" id="nextToPayment">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </form>
            
            <!-- Step 2: Payment - UPDATED WITH SEPARATE FORMS FOR EACH METHOD -->
            <form class="checkout-form" id="paymentForm">
                <div class="payment-methods">
                    <div class="payment-method glass-card selected" data-method="credit">
                        <i class="fas fa-credit-card"></i>
                        <h4>Credit Card</h4>
                        <p>Pay with your credit card</p>
                    </div>
                    <div class="payment-method glass-card" data-method="paypal">
                        <i class="fab fa-paypal"></i>
                        <h4>PayPal</h4>
                        <p>Pay with your PayPal account</p>
                    </div>
                    <div class="payment-method glass-card" data-method="bank">
                        <i class="fas fa-university"></i>
                        <h4>Bank Transfer</h4>
                        <p>Direct bank transfer</p>
                    </div>
                </div>
                
                <!-- Credit Card Form -->
                <div id="credit-card-form" class="payment-form-section active">
                    <div class="form-group">
                        <label for="cardName">Name on Card</label>
                        <input type="text" id="cardName" class="form-input" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="cardNumber">Card Number</label>
                        <input type="text" id="cardNumber" class="form-input" placeholder="1234 5678 9012 3456" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="cardExpiry">Expiry Date</label>
                            <input type="text" id="cardExpiry" class="form-input" placeholder="MM/YY" required>
                        </div>
                        <div class="form-group">
                            <label for="cardCVC">CVC</label>
                            <input type="text" id="cardCVC" class="form-input" placeholder="123" required>
                        </div>
                    </div>
                </div>
                
                <!-- PayPal Form -->
                <div id="paypal-form" class="payment-form-section">
                    <div class="payment-instructions glass-card">
                        <h4><i class="fab fa-paypal"></i> PayPal Payment</h4>
                        <p>You will be redirected to PayPal to complete your payment securely. After completing the payment on PayPal, you will be redirected back to our site to complete your order.</p>
                        
                        <div class="paypal-button-container">
                            <button type="button" class="paypal-button" id="paypalCheckoutBtn">
                                <i class="fab fa-paypal"></i> Checkout with PayPal
                            </button>
                        </div>
                        
                        <div class="paypal-note">
                            <p><i class="fas fa-info-circle"></i> <strong>Note:</strong> Your order will be reserved for 24 hours pending PayPal payment confirmation.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Bank Transfer Form -->
                <div id="bank-transfer-form" class="payment-form-section">
                    <div class="payment-instructions glass-card">
                        <h4><i class="fas fa-university"></i> Bank Transfer Instructions</h4>
                        <p>Please transfer the total amount to our bank account using the details below. Your order will be processed once payment is confirmed.</p>
                        
                        <div class="bank-details">
                            <h5>Bank Account Details</h5>
                            <div class="bank-detail-row">
                                <span class="bank-detail-label">Bank Name:</span>
                                <span class="bank-detail-value">Standard Bank</span>
                            </div>
                            <div class="bank-detail-row">
                                <span class="bank-detail-label">Account Holder:</span>
                                <span class="bank-detail-value">Lonz Flawls Aura (Pty) Ltd</span>
                            </div>
                            <div class="bank-detail-row">
                                <span class="bank-detail-label">Account Number:</span>
                                <span class="bank-detail-value">0123456789 <button class="copy-button" data-copy="0123456789">Copy</button></span>
                            </div>
                            <div class="bank-detail-row">
                                <span class="bank-detail-label">Branch Code:</span>
                                <span class="bank-detail-value">051001 <button class="copy-button" data-copy="051001">Copy</button></span>
                            </div>
                            <div class="bank-detail-row">
                                <span class="bank-detail-label">SWIFT/BIC:</span>
                                <span class="bank-detail-value">SBZAZAJJ <button class="copy-button" data-copy="SBZAZAJJ">Copy</button></span>
                            </div>
                            <div class="bank-detail-row">
                                <span class="bank-detail-label">Reference:</span>
                                <span class="bank-detail-value" id="bankReference">LFA-<span id="dynamicReference">0000</span></span>
                                <button class="copy-button" id="copyReference">Copy</button>
                            </div>
                        </div>
                        
                        <div class="reference-note">
                            <p><i class="fas fa-exclamation-circle"></i> <strong>Important:</strong> Please use the reference number above when making your payment. This ensures your payment is matched to your order.</p>
                        </div>
                        
                        <div style="margin-top: 25px;">
                            <h5>Payment Confirmation</h5>
                            <p>After making the bank transfer, please email your proof of payment to <strong>payments@lonzflawlsaura.co.za</strong> with your order number.</p>
                        </div>
                    </div>
                </div>
                
                <div class="checkout-actions">
                    <button type="button" class="glass-button" id="backToShipping">
                        <i class="fas fa-arrow-left"></i> Back to Shipping
                    </button>
                    <button type="button" class="glass-button" id="nextToReview">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </form>
            
            <!-- Step 3: Review -->
            <div class="checkout-form" id="reviewForm">
                <div class="checkout-review glass-card">
                    <h4 style="margin-bottom: 20px; color: var(--primary-color);">Order Summary</h4>
                    <div id="reviewItems">
                        <!-- Order items will be dynamically added here -->
                    </div>
                    
                    <div class="summary-row">
                        <span>Subtotal</span>
                        <span id="reviewSubtotal">R0.00</span>
                    </div>
                    <div class="summary-row">
                        <span>Shipping</span>
                        <span id="reviewShipping">R50.00</span>
                    </div>
                    <div class="summary-row">
                        <span>Tax</span>
                        <span id="reviewTax">R0.00</span>
                    </div>
                    <div class="summary-row total">
                        <span>Total</span>
                        <span id="reviewTotal">R0.00</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="orderNotes">Order Notes (Optional)</label>
                    <textarea id="orderNotes" class="form-input" rows="3" placeholder="Add special instructions for your order..."></textarea>
                </div>
                
                <div class="form-checkbox">
                    <input type="checkbox" id="agreeTermsCheckout" required>
                    <label for="agreeTermsCheckout">I agree to the Terms & Conditions and Privacy Policy</label>
                </div>
                
                <div class="checkout-actions">
                    <button type="button" class="glass-button" id="backToPayment">
                        <i class="fas fa-arrow-left"></i> Back to Payment
                    </button>
                    <button type="button" class="glass-button" id="placeOrderBtn">
                        <i class="fas fa-lock"></i> Place Order
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal - FIXED BUTTON SPACING -->
    <div class="success-modal" id="successModal">
        <div class="success-content glass-card">
            <button class="close-button" id="closeSuccess">&times;</button>
            <div class="success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="success-message">
                <h3>Order Confirmed!</h3>
                <p>Thank you for your purchase. Your order has been successfully placed and is being processed. You will receive a confirmation email shortly.</p>
                <p style="font-size: 1rem; color: var(--accent-color); margin-top: 20px;">
                    Order ID: <strong>#LFA-<span id="orderId">0000</span></strong>
                </p>
                
                <!-- FIXED: Added proper spacing between buttons -->
                <div class="success-button-container">
                    <button class="glass-button" id="continueShopping">
                        <i class="fas fa-shopping-bag"></i> Continue Shopping
                    </button>
                    <button class="glass-button" style="background: rgba(196, 167, 125, 0.3);">
                        <i class="fas fa-truck"></i> Track Order
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ============ ADMIN PANEL MODAL ============ -->
    <div class="admin-modal" id="adminModal">
        <div class="admin-content">
            <button class="close-button" id="closeAdmin">&times;</button>
            <div class="admin-header">
                <h3><i class="fas fa-crown"></i> Admin Dashboard</h3>
                <div class="glass-button" id="refreshAdmin">
                    <i class="fas fa-sync-alt"></i> Refresh
                </div>
            </div>
            
            <!-- Admin Stats -->
            <div class="admin-stats" id="adminStats">
                <div class="admin-loading">
                    <i class="fas fa-spinner"></i>
                    <p>Loading statistics...</p>
                </div>
            </div>
            
            <!-- Admin Tabs -->
            <div class="admin-tabs">
                <button class="admin-tab active" data-tab="orders">
                    <i class="fas fa-shopping-cart"></i> Orders
                    <span class="admin-tab-badge" id="ordersBadge">0</span>
                </button>
                <button class="admin-tab" data-tab="products">
                    <i class="fas fa-spa"></i> Products
                    <span class="admin-tab-badge" id="productsBadge">0</span>
                </button>
                <button class="admin-tab" data-tab="customers">
                    <i class="fas fa-users"></i> Customers
                    <span class="admin-tab-badge" id="customersBadge">0</span>
                </button>
                <button class="admin-tab" data-tab="analytics">
                    <i class="fas fa-chart-line"></i> Analytics
                </button>
                <button class="admin-tab" data-tab="settings">
                    <i class="fas fa-cog"></i> Settings
                </button>
            </div>
            
            <!-- Orders Section -->
            <div class="admin-section active" id="ordersSection">
                <div class="admin-search-filter">
                    <div class="admin-search-box">
                        <input type="text" id="ordersSearch" placeholder="Search orders by ID, customer, or product...">
                        <i class="fas fa-search"></i>
                    </div>
                    <select class="admin-filter-select" id="ordersFilter">
                        <option value="all">All Status</option>
                        <option value="pending">Pending</option>
                        <option value="processing">Processing</option>
                        <option value="completed">Completed</option>
                        <option value="cancelled">Cancelled</option>
                    </select>
                    <input type="date" class="admin-filter-select" id="ordersDate">
                    <button class="glass-button" id="exportOrders">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
                
                <div class="admin-table-container">
                    <div class="admin-loading" id="ordersLoading">
                        <i class="fas fa-spinner"></i>
                        <p>Loading orders...</p>
                    </div>
                    <table class="admin-table" id="ordersTable" style="display: none;">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Date</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Payment</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTableBody">
                            <!-- Orders will be populated here -->
                        </tbody>
                    </table>
                </div>
                
                <div class="admin-pagination" id="ordersPagination">
                    <!-- Pagination will be added here -->
                </div>
            </div>
            
            <!-- Products Section -->
            <div class="admin-section" id="productsSection">
                <div class="admin-search-filter">
                    <div class="admin-search-box">
                        <input type="text" id="productsSearch" placeholder="Search products by name or category...">
                        <i class="fas fa-search"></i>
                    </div>
                    <select class="admin-filter-select" id="productsFilter">
                        <option value="all">All Categories</option>
                        <option value="oil">Oil</option>
                        <option value="cream">Cream</option>
                        <option value="soap">Soap</option>
                        <option value="lotion">Lotion</option>
                        <option value="combo">Combo</option>
                        <option value="perfume">Perfume</option>
                    </select>
                    <button class="glass-button" id="addProductBtn">
                        <i class="fas fa-plus"></i> Add Product
                    </button>
                </div>
                
                <div class="admin-table-container">
                    <div class="admin-loading" id="productsLoading">
                        <i class="fas fa-spinner"></i>
                        <p>Loading products...</p>
                    </div>
                    <table class="admin-table" id="productsTable" style="display: none;">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Image</th>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Stock</th>
                                <th>Sales</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="productsTableBody">
                            <!-- Products will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Customers Section -->
            <div class="admin-section" id="customersSection">
                <div class="admin-search-filter">
                    <div class="admin-search-box">
                        <input type="text" id="customersSearch" placeholder="Search customers by name or email...">
                        <i class="fas fa-search"></i>
                    </div>
                    <select class="admin-filter-select" id="customersFilter">
                        <option value="all">All Customers</option>
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                        <option value="vip">VIP</option>
                    </select>
                </div>
                
                <div class="admin-table-container">
                    <div class="admin-loading" id="customersLoading">
                        <i class="fas fa-spinner"></i>
                        <p>Loading customers...</p>
                    </div>
                    <table class="admin-table" id="customersTable" style="display: none;">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Orders</th>
                                <th>Total Spent</th>
                                <th>Last Order</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="customersTableBody">
                            <!-- Customers will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Analytics Section -->
            <div class="admin-section" id="analyticsSection">
                <div class="admin-chart-container">
                    <div class="admin-chart-header">
                        <h5>Revenue Overview</h5>
                        <select class="admin-filter-select" id="analyticsPeriod">
                            <option value="7days">Last 7 Days</option>
                            <option value="30days">Last 30 Days</option>
                            <option value="90days">Last 90 Days</option>
                            <option value="year">This Year</option>
                        </select>
                    </div>
                    <div class="admin-chart" id="revenueChart">
                        <div class="admin-loading">
                            <i class="fas fa-spinner"></i>
                            <p>Loading chart...</p>
                        </div>
                    </div>
                </div>
                
                <div class="admin-chart-container">
                    <div class="admin-chart-header">
                        <h5>Top Products</h5>
                    </div>
                    <div class="admin-chart" id="productsChart">
                        <div class="admin-loading">
                            <i class="fas fa-spinner"></i>
                            <p>Loading chart...</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Settings Section -->
            <div class="admin-section" id="settingsSection">
                <div class="admin-form">
                    <div class="admin-form-header">
                        <h4>Store Settings</h4>
                        <button class="glass-button" id="saveSettings">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </div>
                    
                    <div class="admin-form-grid">
                        <div class="admin-form-group">
                            <label for="storeName">Store Name</label>
                            <input type="text" id="storeName" class="form-input" value="Lonz Flawls Aura">
                        </div>
                        
                        <div class="admin-form-group">
                            <label for="storeEmail">Store Email</label>
                            <input type="email" id="storeEmail" class="form-input" value="info@lonzflawlsaura.co.za">
                        </div>
                        
                        <div class="admin-form-group">
                            <label for="storePhone">Store Phone</label>
                            <input type="text" id="storePhone" class="form-input" value="+27 73 551 1216">
                        </div>
                        
                        <div class="admin-form-group">
                            <label for="storeCurrency">Currency</label>
                            <select id="storeCurrency" class="form-input">
                                <option value="ZAR" selected>South African Rand (ZAR)</option>
                                <option value="USD">US Dollar (USD)</option>
                                <option value="EUR">Euro (EUR)</option>
                                <option value="GBP">British Pound (GBP)</option>
                            </select>
                        </div>
                        
                        <div class="admin-form-group">
                            <label for="shippingCost">Shipping Cost (ZAR)</label>
                            <input type="number" id="shippingCost" class="form-input" value="50">
                        </div>
                        
                        <div class="admin-form-group">
                            <label for="taxRate">Tax Rate (%)</label>
                            <input type="number" id="taxRate" class="form-input" value="15" step="0.1">
                        </div>
                    </div>
                    
                    <div class="admin-form-group">
                        <label for="storeDescription">Store Description</label>
                        <textarea id="storeDescription" class="form-input">Premium skincare solutions that combine science and nature to reveal your natural radiance. Experience the transformation with Lonz Flawls Aura.</textarea>
                    </div>
                </div>
                
                <div class="admin-form" style="margin-top: 30px;">
                    <div class="admin-form-header">
                        <h4>Admin Account</h4>
                    </div>
                    
                    <div class="admin-form-grid">
                        <div class="admin-form-group">
                            <label for="adminEmail">Admin Email</label>
                            <input type="email" id="adminEmail" class="form-input" placeholder="Enter admin email">
                        </div>
                        
                        <div class="admin-form-group">
                            <label for="adminPassword">New Password</label>
                            <input type="password" id="adminPassword" class="form-input" placeholder="Enter new password">
                        </div>
                        
                        <div class="admin-form-group">
                            <label for="adminConfirmPassword">Confirm Password</label>
                            <input type="password" id="adminConfirmPassword" class="form-input" placeholder="Confirm new password">
                        </div>
                    </div>
                    
                    <button class="glass-button" id="updateAdmin" style="margin-top: 20px;">
                        <i class="fas fa-user-shield"></i> Update Admin Account
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Admin Notifications Container -->
    <div class="admin-notifications" id="adminNotifications">
        <!-- Notifications will be added here -->
    </div>
    
    <!-- Product Edit Modal -->
    <div class="admin-modal" id="productEditModal">
        <div class="admin-content" style="max-width: 800px;">
            <button class="close-button" id="closeProductEdit">&times;</button>
            <div class="admin-header">
                <h3><i class="fas fa-edit"></i> Edit Product</h3>
            </div>
            
            <div class="admin-form">
                <div class="admin-form-grid">
                    <div class="admin-form-group">
                        <label for="editProductName">Product Name *</label>
                        <input type="text" id="editProductName" class="form-input" required>
                    </div>
                    
                    <div class="admin-form-group">
                        <label for="editProductPrice">Price (ZAR) *</label>
                        <input type="number" id="editProductPrice" class="form-input" step="0.01" required>
                    </div>
                    
                    <div class="admin-form-group">
                        <label for="editProductCategory">Category *</label>
                        <select id="editProductCategory" class="form-input" required>
                            <option value="oil">Oil</option>
                            <option value="cream">Cream</option>
                            <option value="soap">Soap</option>
                            <option value="lotion">Lotion</option>
                            <option value="combo">Combo</option>
                            <option value="perfume">Perfume</option>
                            <option value="home fragrance">Home Fragrance</option>
                            <option value="body care">Body Care</option>
                            <option value="personal care">Personal Care</option>
                        </select>
                    </div>
                    
                    <div class="admin-form-group">
                        <label for="editProductStock">Stock Quantity</label>
                        <input type="number" id="editProductStock" class="form-input" value="100">
                    </div>
                    
                    <div class="admin-form-group">
                        <label for="editProductImage">Image URL *</label>
                        <input type="text" id="editProductImage" class="form-input" required>
                    </div>
                    
                    <div class="admin-form-group">
                        <label for="editProductSection">Section *</label>
                        <select id="editProductSection" class="form-input" required>
                            <option value="all-products">All Products</option>
                            <option value="products">Recommended</option>
                            <option value="flagship">Flagship</option>
                        </select>
                    </div>
                </div>
                
                <div class="admin-form-group">
                    <label for="editProductDescription">Description *</label>
                    <textarea id="editProductDescription" class="form-input" rows="3" required></textarea>
                </div>
                
                <div class="admin-form-grid">
                    <div class="admin-form-group">
                        <label for="editProductBenefits">Benefits</label>
                        <textarea id="editProductBenefits" class="form-input" rows="2"></textarea>
                    </div>
                    
                    <div class="admin-form-group">
                        <label for="editProductUsage">Usage Instructions</label>
                        <textarea id="editProductUsage" class="form-input" rows="2"></textarea>
                    </div>
                </div>
                
                <div class="admin-form-group">
                    <label for="editProductIngredients">Active Ingredients</label>
                    <textarea id="editProductIngredients" class="form-input" rows="2"></textarea>
                </div>
                
                <div class="admin-form-grid">
                    <div class="admin-form-group">
                        <label for="editProductBadge">Badge</label>
                        <select id="editProductBadge" class="form-input">
                            <option value="">None</option>
                            <option value="recommended">Recommended</option>
                            <option value="bestseller">Bestseller</option>
                            <option value="flagship">Flagship</option>
                            <option value="new">New</option>
                            <option value="premium">Premium</option>
                        </select>
                    </div>
                    
                    <div class="admin-form-group">
                        <label for="editProductSearchScore">Search Score (0-100)</label>
                        <input type="number" id="editProductSearchScore" class="form-input" min="0" max="100" value="50">
                    </div>
                </div>
                
                <div class="admin-form-group">
                    <label for="editProductTags">Tags (comma separated)</label>
                    <input type="text" id="editProductTags" class="form-input" placeholder="acne, brightening, moisturizing">
                </div>
                
                <div class="admin-actions" style="margin-top: 30px;">
                    <button class="glass-button" id="saveProductBtn" style="background: rgba(40, 167, 69, 0.3);">
                        <i class="fas fa-save"></i> Save Product
                    </button>
                    <button class="glass-button" id="deleteProductBtn" style="background: rgba(220, 53, 69, 0.3);">
                        <i class="fas fa-trash"></i> Delete Product
                    </button>
                    <button class="glass-button" id="cancelProductEdit">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Order Details Modal -->
    <div class="admin-modal" id="orderDetailsModal">
        <div class="admin-content" style="max-width: 1000px;">
            <button class="close-button" id="closeOrderDetails">&times;</button>
            <div class="admin-header">
                <h3><i class="fas fa-receipt"></i> Order Details</h3>
                <div class="glass-button" id="printOrderBtn">
                    <i class="fas fa-print"></i> Print
                </div>
            </div>
            
            <div id="orderDetailsContent">
                <div class="admin-loading">
                    <i class="fas fa-spinner"></i>
                    <p>Loading order details...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
    
    <!-- Mobile Navigation Links -->
    <div class="mobile-nav-links" id="mobileNavLinks">
        <i class="fas fa-times mobile-menu-close" id="mobileMenuClose"></i>
        <a href="#hero" class="mobile-nav-link">Home</a>
        <a href="#products" class="mobile-nav-link">Products</a>
        <a href="#all-products" class="mobile-nav-link">All Products</a>
        <a href="#gallery" class="mobile-nav-link">Gallery</a>
        <a href="#social" class="mobile-nav-link">Connect</a>
    </div>

    <!-- Navigation - ENLARGED BY 50% -->
    <nav id="navbar">
        <a href="#" class="logo"><i class="fas fa-spa"></i> Lonz Flawls Aura</a>
        <div class="nav-links">
            <a href="#hero">Home</a>
            <a href="#products">Products</a>
            <a href="#all-products">All Products</a>
            <a href="#gallery">Gallery</a>
            <a href="#social">Connect</a>
        </div>
        <div class="nav-icons">
            <!-- Admin Button -->
            <button class="admin-nav-btn" id="adminBtn">
                <i class="fas fa-crown"></i> Admin
            </button>
            
            <!-- Search Container -->
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="Search products or skin issues...">
                <i class="fas fa-search search-icon" id="searchIcon"></i>
                <i class="fas fa-times search-close" id="searchClose"></i>
                <!-- Enhanced Search Results -->
                <div class="search-results" id="searchResults">
                    <!-- Content will be populated dynamically -->
                </div>
            </div>
            <!-- Menu Button -->
            <div class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Hero Section -->
        <section id="hero" class="hero">
            <div class="fade-in">
                <h1>Discover Your Glow</h1>
                <p>Lonz Flawls Aura combines science and nature to create premium skincare solutions that reveal your natural radiance. Experience the transformation.</p>
                <div class="hero-buttons">
                    <button class="glass-button start-qualification"><i class="fas fa-star"></i> Start Now</button>
                    <button class="glass-button"><i class="fas fa-play-circle"></i> Watch Our Story</button>
                </div>
            </div>
            <div class="scroll-indicator">
                <span>Scroll to explore</span>
                <i class="fas fa-chevron-down"></i>
            </div>
        </section>

        <!-- Lead Qualification Wizard -->
        <section id="qualification">
            <div class="lead-wizard glass-card fade-in">
                <button class="close-button" id="closeWizard">&times;</button>
                <div class="wizard-header">
                    <div class="wizard-avatar">
                        <i class="fas fa-spa"></i>
                    </div>
                    <div class="wizard-title">
                        <h3>Skin Analysis Wizard</h3>
                        <p>Answer a few questions to get personalized recommendations</p>
                    </div>
                </div>
                
                <div class="wizard-content">
                    <!-- Step 1: Skin Concern -->
                    <div class="wizard-step active" id="step1">
                        <h4>What is your primary skin concern?</h4>
                        <div class="option-grid">
                            <div class="option-item glass-card" data-value="acne">
                                <i class="fas fa-leaf"></i>
                                <p>Acne & Breakouts</p>
                            </div>
                            <div class="option-item glass-card" data-value="dark-spots">
                                <i class="fas fa-circle"></i>
                                <p>Dark Spots</p>
                            </div>
                            <div class="option-item glass-card" data-value="dry">
                                <i class="fas fa-tint"></i>
                                <p>Dryness</p>
                            </div>
                            <div class="option-item glass-card" data-value="uneven-tone">
                                <i class="fas fa-palette"></i>
                                <p>Uneven Tone</p>
                            </div>
                            <div class="option-item glass-card" data-value="glow">
                                <i class="fas fa-sun"></i>
                                <p>Glow Maintenance</p>
                            </div>
                        </div>
                        <div class="wizard-actions">
                            <button class="glass-button wizard-next" data-step="1">Next <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                    
                    <!-- Step 2: Skin Sensitivity -->
                    <div class="wizard-step" id="step2">
                        <h4>How sensitive is your skin?</h4>
                        <div class="option-grid">
                            <div class="option-item glass-card" data-value="very-sensitive">
                                <i class="fas fa-exclamation-circle"></i>
                                <p>Very Sensitive</p>
                            </div>
                            <div class="option-item glass-card" data-value="sensitive">
                                <i class="fas fa-low-vision"></i>
                                <p>Sensitive</p>
                            </div>
                            <div class="option-item glass-card" data-value="normal">
                                <i class="fas fa-check-circle"></i>
                                <p>Normal</p>
                            </div>
                            <div class="option-item glass-card" data-value="resilient">
                                <i class="fas fa-shield-alt"></i>
                                <p>Resilient</p>
                            </div>
                        </div>
                        <div class="wizard-actions">
                            <button class="glass-button wizard-prev"><i class="fas fa-arrow-left"></i> Back</button>
                            <button class="glass-button wizard-next" data-step="2">Next <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>
                    
                    <!-- Step 3: Skin Age -->
                    <div class="wizard-step" id="step3">
                        <h4>What is your skin age range?</h4>
                        <div class="option-grid">
                            <div class="option-item glass-card" data-value="under-25">
                                <i class="fas fa-child"></i>
                                <p>Under 25</p>
                            </div>
                            <div class="option-item glass-card" data-value="25-35">
                                <i class="fas fa-user"></i>
                                <p>25-35</p>
                            </div>
                            <div class="option-item glass-card" data-value="36-50">
                                <i class="fas fa-user-friends"></i>
                                <p>36-50</p>
                            </div>
                            <div class="option-item glass-card" data-value="50-plus">
                                <i class="fas fa-crown"></i>
                                <p>50+</p>
                            </div>
                        </div>
                        <div class="wizard-actions">
                            <button class="glass-button wizard-prev"><i class="fas fa-arrow-left"></i> Back</button>
                            <button class="glass-button wizard-next" data-step="3">Get Recommendations</button>
                        </div>
                    </div>
                </div>
                
                <div class="wizard-progress">
                    <div class="wizard-progress-bar" id="progressBar"></div>
                </div>
            </div>
        </section>

        <!-- Recommended Combos -->
        <section id="products">
            <div class="section-header fade-in">
                <h2>Recommended For You</h2>
                <p>Based on your skin profile, we recommend these combos for optimal results</p>
            </div>
            
            <div class="products-grid fade-in" id="recommendedProductsGrid">
                <!-- Products will be loaded from Supabase -->
            </div>
        </section>

        <!-- Flagship Product -->
        <section id="flagship">
            <div class="section-header fade-in">
                <h2>Flagship Whitening Oil</h2>
                <p>Our most advanced formula for radiant, even-toned skin. Experience the transformation.</p>
            </div>
            
            <div class="products-grid fade-in" id="flagshipProductsGrid">
                <!-- Flagship products will be loaded from Supabase -->
            </div>
        </section>

        <!-- All Products -->
        <section id="all-products">
            <div class="section-header fade-in">
                <h2>All Products</h2>
                <p>Explore our complete range of premium skincare products</p>
            </div>
            
            <div class="products-grid fade-in" id="allProductsGrid">
                <!-- All products will be loaded from Supabase -->
            </div>
        </section>

        <!-- Gallery -->
        <section id="gallery">
            <div class="section-header fade-in">
                <h2>Glow Gallery</h2>
                <p>See the transformation and lifestyle with Lonz Flawls Aura</p>
            </div>
            
            <div class="gallery-container fade-in">
                <div class="gallery-track" id="galleryTrack">
                    <div class="gallery-slide glass-card">
                        <img src="https://images.unsplash.com/photo-1522335789203-aabd1fc54bc9?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" alt="Skincare products">
                    </div>
                    <div class="gallery-slide glass-card">
                        <img src="https://images.unsplash.com/photo-1556228578-9c360e1d8d34?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" alt="Product application">
                    </div>
                    <div class="gallery-slide glass-card">
                        <img src="https://images.unsplash.com/photo-1571781926291-c477ebfd024b?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" alt="Natural ingredients">
                    </div>
                    <div class="gallery-slide glass-card">
                        <img src="https://images.unsplash.com/photo-1596462502278-27bfdc403348?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" alt="Luxury skincare">
                    </div>
                    <div class="gallery-slide glass-card">
                        <img src="https://images.unsplash.com/photo-1556228453-efd6c1ff04f6?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" alt="Radiant skin results">
                    </div>
                </div>
                
                <div class="gallery-nav">
                    <div class="gallery-dot active" data-index="0"></div>
                    <div class="gallery-dot" data-index="1"></div>
                    <div class="gallery-dot" data-index="2"></div>
                    <div class="gallery-dot" data-index="3"></div>
                    <div class="gallery-dot" data-index="4"></div>
                </div>
            </div>
        </section>

        <!-- Social Links Section -->
        <section id="social" class="social-section">
            <div class="fade-in">
                <h3>Join Our Glow Community</h3>
                <p>Follow us for skincare tips, behind-the-scenes, and exclusive offers</p>
                <div class="social-links-container">
                    <a href="https://www.facebook.com/lonia.mongwe" target="_blank" class="social-button facebook">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="https://www.tiktok.com/@loniamongwe?_r=1&_t=ZS-92GQkfgjDU4" target="_blank" class="social-button tiktok">
                        <i class="fab fa-tiktok"></i>
                    </a>
                    <a href="https://wa.me/+27735511216" target="_blank" class="social-button whatsapp">
                        <i class="fab fa-whatsapp"></i>
                    </a>
                    <a href="mailto:mongwelonia@gmail.com" target="_blank" class="social-button email">
                        <i class="fas fa-envelope"></i>
                    </a>
                    <a href="https://www.instagram.com/mongwelonia?igsh=MXBoN2s5YnVzeHFxbg==" target="_blank" class="social-button instagram">
                        <i class="fab fa-instagram"></i>
                    </a>
                </div>
                <div style="margin-top: 30px;">
                    <p style="color: rgba(255, 255, 255, 0.8);">Direct WhatsApp: <strong>+27 73 551 1216</strong></p>
                    <p style="color: rgba(255, 255, 255, 0.8); margin-top: 10px;">Email: <strong>mongwelonia@gmail.com</strong></p>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer id="footer">
            <div class="footer-content fade-in">
                <div class="footer-column">
                    <h4>Lonz Flawls Aura</h4>
                    <p>Premium skincare solutions that combine science and nature to reveal your natural radiance. Start your glow journey today.</p>
                </div>
                
                <div class="footer-column">
                    <h4>Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="#hero">Home</a></li>
                        <li><a href="#products">Products</a></li>
                        <li><a href="#all-products">All Products</a></li>
                        <li><a href="#gallery">Gallery</a></li>
                        <li><a href="#social">Connect</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h4>Contact Info</h4>
                    <p><i class="fab fa-whatsapp"></i> +27 73 551 1216</p>
                    <p><i class="fas fa-envelope"></i> mongwelonia@gmail.com</p>
                    <p><i class="fas fa-map-marker-alt"></i> South Africa</p>
                </div>
                
                <div class="footer-column">
                    <h4>Join Our Glow Club</h4>
                    <p>Subscribe to get exclusive offers, skincare tips, and early access to new products.</p>
                    <div class="newsletter-form">
                        <input type="email" placeholder="Your email address">
                        <button class="glass-button">Subscribe</button>
                    </div>
                </div>
            </div>
            
            <div class="copyright">
                <p>&copy; 2023 Lonz Flawls Aura. All rights reserved. | Premium Skincare</p>
            </div>
        </footer>
    </div>

    <!-- Results Modal - UPDATED LAYOUT -->
    <div class="results-modal" id="resultsModal">
        <button class="close-button" id="closeResults">&times;</button>
        
        <!-- Affirmations Section - FREE STANDING -->
        <div class="affirmations-section fade-in">
            <div class="result-icon">
                <i class="fas fa-spa"></i>
            </div>
            <div class="result-message">
                <h3>Your Personalized Glow Plan</h3>
                <p id="resultDescription"></p>
            </div>
        </div>
        
        <!-- Products Section - IN GLASS CARD -->
        <div class="results-products-section">
            <div class="results-products-container glass-card">
                <div class="personalized-products-container" id="personalizedProducts">
                    <!-- Personalized products will be dynamically added here as product cards -->
                </div>
                
                <div class="result-actions">
                    <button class="glass-button" id="closeResultsBtn">Continue Browsing</button>
                    <button class="glass-button" style="background: rgba(196, 167, 125, 0.3); margin-left: 15px;" id="addAllToCart">
                        <i class="fas fa-shopping-cart"></i> Add All to Cart
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============ SUPABASE CONFIGURATION ============
        // Replace these with your actual Supabase credentials
        const SUPABASE_URL = 'https://your-project.supabase.co';
        const SUPABASE_ANON_KEY = 'your-anon-key';
        
        // Initialize Supabase client
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        // ============ GLOBAL VARIABLES ============
        let currentUser = null;
        let isAdmin = false;
        let allProducts = [];
        let orders = [];
        let customers = [];
        
        // ============ DOM ELEMENTS ============
        const adminBtn = document.getElementById('adminBtn');
        const adminModal = document.getElementById('adminModal');
        const closeAdminBtn = document.getElementById('closeAdmin');
        
        // ============ INITIALIZATION ============
        document.addEventListener('DOMContentLoaded', async () => {
            // Check if user is logged in
            await checkAuthStatus();
            
            // Load products from Supabase
            await loadProducts();
            
            // Initialize admin panel if user is admin
            if (isAdmin) {
                initializeAdminPanel();
            } else {
                // Hide admin button if not admin
                adminBtn.style.display = 'none';
            }
            
            // Initialize existing functionality
            initializeExistingFunctionality();
        });
        
        // ============ AUTHENTICATION FUNCTIONS ============
        async function checkAuthStatus() {
            const { data: { user }, error } = await supabase.auth.getUser();
            
            if (user) {
                currentUser = user;
                // Check if user is admin
                const { data: adminData, error: adminError } = await supabase
                    .from('admin_users')
                    .select('*')
                    .eq('user_id', user.id)
                    .single();
                
                isAdmin = !!adminData;
            }
        }
        
        // ============ PRODUCT FUNCTIONS ============
        async function loadProducts() {
            try {
                const { data, error } = await supabase
                    .from('products')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                
                allProducts = data;
                
                // Render products to the page
                renderProducts();
            } catch (error) {
                console.error('Error loading products:', error);
                showNotification('Error loading products', 'error');
            }
        }
        
        function renderProducts() {
            // Clear existing content
            document.getElementById('recommendedProductsGrid').innerHTML = '';
            document.getElementById('flagshipProductsGrid').innerHTML = '';
            document.getElementById('allProductsGrid').innerHTML = '';
            
            // Render recommended products (section = 'products')
            const recommendedProducts = allProducts.filter(p => p.section === 'products');
            recommendedProducts.forEach(product => {
                document.getElementById('recommendedProductsGrid').innerHTML += createProductCard(product);
            });
            
            // Render flagship products (section = 'flagship')
            const flagshipProducts = allProducts.filter(p => p.section === 'flagship');
            flagshipProducts.forEach(product => {
                document.getElementById('flagshipProductsGrid').innerHTML += createProductCard(product);
            });
            
            // Render all products
            allProducts.forEach(product => {
                document.getElementById('allProductsGrid').innerHTML += createProductCard(product);
            });
            
            // Re-initialize add to cart buttons
            initializeAddToCartButtons();
        }
        
        function createProductCard(product) {
            let badgeHTML = '';
            if (product.badge) {
                let badgeClass = 'badge-recommended';
                if (product.badge === 'bestseller') badgeClass = 'badge-bestseller';
                if (product.badge === 'flagship') badgeClass = 'badge-flagship';
                if (product.badge === 'new') badgeClass = 'badge-new';
                if (product.badge === 'premium') badgeClass = 'badge-premium';
                
                badgeHTML = `<div class="product-badge ${badgeClass}">${product.badge}</div>`;
            }
            
            let detailsHTML = '';
            if (product.benefits || product.usage || product.ingredients) {
                detailsHTML = `
                    <div class="product-details">
                        ${product.benefits ? `<div class="product-benefits"><strong>Benefits:</strong> ${product.benefits}</div>` : ''}
                        ${product.usage ? `<div class="product-usage"><strong>Usage:</strong> ${product.usage}</div>` : ''}
                        ${product.ingredients ? `<div class="product-ingredients"><strong>Active Ingredients:</strong> ${product.ingredients}</div>` : ''}
                    </div>
                `;
            }
            
            return `
                <div class="product-card glass-card ${product.section === 'flagship' ? 'flagship-card' : ''}">
                    ${badgeHTML}
                    <div class="product-image" style="background-image: url('${product.image_url}');"></div>
                    <div class="product-info">
                        <h3>${product.name}</h3>
                        <p>${product.description}</p>
                        ${detailsHTML}
                        <div class="product-price">R${parseFloat(product.price).toFixed(2)}</div>
                    </div>
                    <button class="glass-button add-to-cart" 
                        data-id="${product.id}"
                        data-name="${product.name}"
                        data-price="${product.price}"
                        data-image="${product.image_url}">
                        <i class="fas fa-cart-plus"></i> Add to Cart
                    </button>
                </div>
            `;
        }
        
        // ============ ADMIN PANEL FUNCTIONS ============
        function initializeAdminPanel() {
            // Show admin button
            adminBtn.style.display = 'flex';
            
            // Add event listeners
            adminBtn.addEventListener('click', openAdminPanel);
            closeAdminBtn.addEventListener('click', closeAdminPanel);
            
            // Initialize admin tabs
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    switchAdminTab(tabId);
                });
            });
            
            // Initialize refresh button
            document.getElementById('refreshAdmin').addEventListener('click', refreshAdminData);
            
            // Initialize add product button
            document.getElementById('addProductBtn').addEventListener('click', openAddProductModal);
            
            // Initialize other admin buttons
            initializeAdminButtons();
        }
        
        function openAdminPanel() {
            adminModal.classList.add('active');
            loadAdminData();
        }
        
        function closeAdminPanel() {
            adminModal.classList.remove('active');
        }
        
        async function loadAdminData() {
            // Load stats
            await loadAdminStats();
            
            // Load orders
            await loadOrders();
            
            // Load products for admin
            await loadAdminProducts();
            
            // Load customers
            await loadCustomers();
        }
        
        async function loadAdminStats() {
            try {
                // Get total orders count
                const { count: ordersCount, error: ordersError } = await supabase
                    .from('orders')
                    .select('*', { count: 'exact', head: true });
                
                // Get total products count
                const { count: productsCount, error: productsError } = await supabase
                    .from('products')
                    .select('*', { count: 'exact', head: true });
                
                // Get total customers count
                const { count: customersCount, error: customersError } = await supabase
                    .from('customers')
                    .select('*', { count: 'exact', head: true });
                
                // Get total revenue
                const { data: revenueData, error: revenueError } = await supabase
                    .from('orders')
                    .select('total_amount')
                    .eq('status', 'completed');
                
                const totalRevenue = revenueData?.reduce((sum, order) => sum + parseFloat(order.total_amount || 0), 0) || 0;
                
                // Update stats display
                document.getElementById('adminStats').innerHTML = `
                    <div class="admin-stat-card">
                        <i class="fas fa-shopping-cart"></i>
                        <h4>${ordersCount || 0}</h4>
                        <p>Total Orders</p>
                    </div>
                    <div class="admin-stat-card">
                        <i class="fas fa-spa"></i>
                        <h4>${productsCount || 0}</h4>
                        <p>Products</p>
                    </div>
                    <div class="admin-stat-card">
                        <i class="fas fa-users"></i>
                        <h4>${customersCount || 0}</h4>
                        <p>Customers</p>
                    </div>
                    <div class="admin-stat-card">
                        <i class="fas fa-money-bill-wave"></i>
                        <h4>R${totalRevenue.toFixed(2)}</h4>
                        <p>Total Revenue</p>
                    </div>
                `;
                
                // Update badge counts
                document.getElementById('ordersBadge').textContent = ordersCount || 0;
                document.getElementById('productsBadge').textContent = productsCount || 0;
                document.getElementById('customersBadge').textContent = customersCount || 0;
                
            } catch (error) {
                console.error('Error loading admin stats:', error);
                showNotification('Error loading statistics', 'error');
            }
        }
        
        async function loadOrders(page = 1, limit = 10) {
            try {
                const ordersLoading = document.getElementById('ordersLoading');
                const ordersTable = document.getElementById('ordersTable');
                const ordersTableBody = document.getElementById('ordersTableBody');
                
                ordersLoading.style.display = 'flex';
                ordersTable.style.display = 'none';
                
                // Calculate offset for pagination
                const offset = (page - 1) * limit;
                
                // Get orders from Supabase
                const { data, error, count } = await supabase
                    .from('orders')
                    .select('*', { count: 'exact' })
                    .order('created_at', { ascending: false })
                    .range(offset, offset + limit - 1);
                
                if (error) throw error;
                
                orders = data || [];
                
                // Clear table body
                ordersTableBody.innerHTML = '';
                
                // Populate table
                orders.forEach(order => {
                    const statusClass = `status-${order.status || 'pending'}`;
                    const statusText = (order.status || 'pending').charAt(0).toUpperCase() + (order.status || 'pending').slice(1);
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>#${order.id}</td>
                        <td>${order.customer_name || 'N/A'}</td>
                        <td>${new Date(order.created_at).toLocaleDateString()}</td>
                        <td>R${parseFloat(order.total_amount || 0).toFixed(2)}</td>
                        <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                        <td>${order.payment_method || 'N/A'}</td>
                        <td>
                            <button class="admin-action-btn view" data-id="${order.id}">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="admin-action-btn edit" data-id="${order.id}">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                        </td>
                    `;
                    ordersTableBody.appendChild(row);
                });
                
                // Update pagination
                updatePagination('ordersPagination', page, Math.ceil((count || 0) / limit), loadOrders);
                
                // Add event listeners to action buttons
                document.querySelectorAll('#ordersTableBody .admin-action-btn.view').forEach(btn => {
                    btn.addEventListener('click', () => viewOrderDetails(btn.getAttribute('data-id')));
                });
                
                document.querySelectorAll('#ordersTableBody .admin-action-btn.edit').forEach(btn => {
                    btn.addEventListener('click', () => editOrder(btn.getAttribute('data-id')));
                });
                
                ordersLoading.style.display = 'none';
                ordersTable.style.display = 'table';
                
            } catch (error) {
                console.error('Error loading orders:', error);
                showNotification('Error loading orders', 'error');
            }
        }
        
        async function loadAdminProducts() {
            try {
                const productsLoading = document.getElementById('productsLoading');
                const productsTable = document.getElementById('productsTable');
                const productsTableBody = document.getElementById('productsTableBody');
                
                productsLoading.style.display = 'flex';
                productsTable.style.display = 'none';
                
                // Get products from Supabase
                const { data, error } = await supabase
                    .from('products')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                
                // Clear table body
                productsTableBody.innerHTML = '';
                
                // Populate table
                data.forEach(product => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${product.id}</td>
                        <td><img src="${product.image_url}" alt="${product.name}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 5px;"></td>
                        <td>${product.name}</td>
                        <td>${product.category}</td>
                        <td>R${parseFloat(product.price).toFixed(2)}</td>
                        <td>${product.stock_quantity || 0}</td>
                        <td>${product.sales_count || 0}</td>
                        <td>
                            <button class="admin-action-btn edit" data-id="${product.id}">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="admin-action-btn delete" data-id="${product.id}">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </td>
                    `;
                    productsTableBody.appendChild(row);
                });
                
                // Add event listeners to action buttons
                document.querySelectorAll('#productsTableBody .admin-action-btn.edit').forEach(btn => {
                    btn.addEventListener('click', () => editProduct(btn.getAttribute('data-id')));
                });
                
                document.querySelectorAll('#productsTableBody .admin-action-btn.delete').forEach(btn => {
                    btn.addEventListener('click', () => deleteProduct(btn.getAttribute('data-id')));
                });
                
                productsLoading.style.display = 'none';
                productsTable.style.display = 'table';
                
            } catch (error) {
                console.error('Error loading products:', error);
                showNotification('Error loading products', 'error');
            }
        }
        
        async function loadCustomers() {
            try {
                const customersLoading = document.getElementById('customersLoading');
                const customersTable = document.getElementById('customersTable');
                const customersTableBody = document.getElementById('customersTableBody');
                
                customersLoading.style.display = 'flex';
                customersTable.style.display = 'none';
                
                // Get customers from Supabase
                const { data, error } = await supabase
                    .from('customers')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                
                customers = data || [];
                
                // Clear table body
                customersTableBody.innerHTML = '';
                
                // Populate table
                customers.forEach(customer => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${customer.id}</td>
                        <td>${customer.full_name || 'N/A'}</td>
                        <td>${customer.email}</td>
                        <td>${customer.order_count || 0}</td>
                        <td>R${parseFloat(customer.total_spent || 0).toFixed(2)}</td>
                        <td>${customer.last_order_date ? new Date(customer.last_order_date).toLocaleDateString() : 'N/A'}</td>
                        <td><span class="status-badge ${customer.status === 'active' ? 'status-completed' : 'status-pending'}">${customer.status || 'inactive'}</span></td>
                        <td>
                            <button class="admin-action-btn view" data-id="${customer.id}">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="admin-action-btn edit" data-id="${customer.id}">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                        </td>
                    `;
                    customersTableBody.appendChild(row);
                });
                
                customersLoading.style.display = 'none';
                customersTable.style.display = 'table';
                
            } catch (error) {
                console.error('Error loading customers:', error);
                showNotification('Error loading customers', 'error');
            }
        }
        
        function switchAdminTab(tabId) {
            // Update active tab
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`.admin-tab[data-tab="${tabId}"]`).classList.add('active');
            
            // Update active section
            document.querySelectorAll('.admin-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(`${tabId}Section`).classList.add('active');
            
            // Load data for the selected tab if needed
            if (tabId === 'analytics') {
                loadAnalytics();
            }
        }
        
        function refreshAdminData() {
            loadAdminData();
            showNotification('Admin data refreshed', 'success');
        }
        
        function initializeAdminButtons() {
            // Export orders button
            document.getElementById('exportOrders').addEventListener('click', exportOrders);
            
            // Save settings button
            document.getElementById('saveSettings').addEventListener('click', saveSettings);
            
            // Update admin account button
            document.getElementById('updateAdmin').addEventListener('click', updateAdminAccount);
            
            // Close modals
            document.getElementById('closeProductEdit').addEventListener('click', () => {
                document.getElementById('productEditModal').classList.remove('active');
            });
            
            document.getElementById('cancelProductEdit').addEventListener('click', () => {
                document.getElementById('productEditModal').classList.remove('active');
            });
            
            document.getElementById('closeOrderDetails').addEventListener('click', () => {
                document.getElementById('orderDetailsModal').classList.remove('active');
            });
            
            // Save product button
            document.getElementById('saveProductBtn').addEventListener('click', saveProduct);
            
            // Delete product button
            document.getElementById('deleteProductBtn').addEventListener('click', deleteCurrentProduct);
            
            // Print order button
            document.getElementById('printOrderBtn').addEventListener('click', printOrder);
        }
        
        // ============ PRODUCT MANAGEMENT FUNCTIONS ============
        function openAddProductModal() {
            // Reset form
            document.getElementById('editProductName').value = '';
            document.getElementById('editProductPrice').value = '';
            document.getElementById('editProductCategory').value = 'oil';
            document.getElementById('editProductStock').value = '100';
            document.getElementById('editProductImage').value = '';
            document.getElementById('editProductSection').value = 'all-products';
            document.getElementById('editProductDescription').value = '';
            document.getElementById('editProductBenefits').value = '';
            document.getElementById('editProductUsage').value = '';
            document.getElementById('editProductIngredients').value = '';
            document.getElementById('editProductBadge').value = '';
            document.getElementById('editProductSearchScore').value = '50';
            document.getElementById('editProductTags').value = '';
            
            // Set modal title
            document.querySelector('#productEditModal .admin-header h3').innerHTML = '<i class="fas fa-plus"></i> Add New Product';
            
            // Show modal
            document.getElementById('productEditModal').classList.add('active');
        }
        
        async function editProduct(productId) {
            try {
                // Get product data
                const { data: product, error } = await supabase
                    .from('products')
                    .select('*')
                    .eq('id', productId)
                    .single();
                
                if (error) throw error;
                
                // Fill form with product data
                document.getElementById('editProductName').value = product.name;
                document.getElementById('editProductPrice').value = product.price;
                document.getElementById('editProductCategory').value = product.category;
                document.getElementById('editProductStock').value = product.stock_quantity || 100;
                document.getElementById('editProductImage').value = product.image_url;
                document.getElementById('editProductSection').value = product.section;
                document.getElementById('editProductDescription').value = product.description;
                document.getElementById('editProductBenefits').value = product.benefits || '';
                document.getElementById('editProductUsage').value = product.usage || '';
                document.getElementById('editProductIngredients').value = product.ingredients || '';
                document.getElementById('editProductBadge').value = product.badge || '';
                document.getElementById('editProductSearchScore').value = product.search_score || 50;
                document.getElementById('editProductTags').value = product.tags || '';
                
                // Set modal title
                document.querySelector('#productEditModal .admin-header h3').innerHTML = `<i class="fas fa-edit"></i> Edit Product: ${product.name}`;
                
                // Store current product ID
                document.getElementById('productEditModal').setAttribute('data-current-product-id', productId);
                
                // Show modal
                document.getElementById('productEditModal').classList.add('active');
                
            } catch (error) {
                console.error('Error loading product for edit:', error);
                showNotification('Error loading product', 'error');
            }
        }
        
        async function saveProduct() {
            try {
                const productId = document.getElementById('productEditModal').getAttribute('data-current-product-id');
                const isEdit = !!productId;
                
                const productData = {
                    name: document.getElementById('editProductName').value,
                    price: parseFloat(document.getElementById('editProductPrice').value),
                    category: document.getElementById('editProductCategory').value,
                    stock_quantity: parseInt(document.getElementById('editProductStock').value) || 100,
                    image_url: document.getElementById('editProductImage').value,
                    section: document.getElementById('editProductSection').value,
                    description: document.getElementById('editProductDescription').value,
                    benefits: document.getElementById('editProductBenefits').value,
                    usage: document.getElementById('editProductUsage').value,
                    ingredients: document.getElementById('editProductIngredients').value,
                    badge: document.getElementById('editProductBadge').value || null,
                    search_score: parseInt(document.getElementById('editProductSearchScore').value) || 50,
                    tags: document.getElementById('editProductTags').value,
                    updated_at: new Date().toISOString()
                };
                
                let error;
                
                if (isEdit) {
                    // Update existing product
                    const { error: updateError } = await supabase
                        .from('products')
                        .update(productData)
                        .eq('id', productId);
                    
                    error = updateError;
                } else {
                    // Insert new product
                    productData.created_at = new Date().toISOString();
                    productData.sales_count = 0;
                    
                    const { error: insertError } = await supabase
                        .from('products')
                        .insert([productData]);
                    
                    error = insertError;
                }
                
                if (error) throw error;
                
                // Close modal
                document.getElementById('productEditModal').classList.remove('active');
                
                // Refresh products
                await loadProducts();
                await loadAdminProducts();
                
                showNotification(`Product ${isEdit ? 'updated' : 'added'} successfully`, 'success');
                
            } catch (error) {
                console.error('Error saving product:', error);
                showNotification('Error saving product', 'error');
            }
        }
        
        async function deleteProduct(productId) {
            if (!confirm('Are you sure you want to delete this product? This action cannot be undone.')) {
                return;
            }
            
            try {
                const { error } = await supabase
                    .from('products')
                    .delete()
                    .eq('id', productId);
                
                if (error) throw error;
                
                // Refresh products
                await loadProducts();
                await loadAdminProducts();
                
                showNotification('Product deleted successfully', 'success');
                
            } catch (error) {
                console.error('Error deleting product:', error);
                showNotification('Error deleting product', 'error');
            }
        }
        
        function deleteCurrentProduct() {
            const productId = document.getElementById('productEditModal').getAttribute('data-current-product-id');
            if (productId) {
                deleteProduct(productId);
                document.getElementById('productEditModal').classList.remove('active');
            }
        }
        
        // ============ ORDER MANAGEMENT FUNCTIONS ============
        async function viewOrderDetails(orderId) {
            try {
                // Get order details
                const { data: order, error } = await supabase
                    .from('orders')
                    .select('*')
                    .eq('id', orderId)
                    .single();
                
                if (error) throw error;
                
                // Get order items
                const { data: orderItems, error: itemsError } = await supabase
                    .from('order_items')
                    .select('*')
                    .eq('order_id', orderId);
                
                if (itemsError) throw itemsError;
                
                // Format order details
                const orderDetailsHTML = `
                    <div class="admin-form">
                        <div class="admin-form-grid">
                            <div class="admin-form-group">
                                <label>Order ID</label>
                                <div class="form-input" style="background: rgba(255,255,255,0.05);">#${order.id}</div>
                            </div>
                            <div class="admin-form-group">
                                <label>Order Date</label>
                                <div class="form-input" style="background: rgba(255,255,255,0.05);">${new Date(order.created_at).toLocaleString()}</div>
                            </div>
                            <div class="admin-form-group">
                                <label>Status</label>
                                <div class="form-input" style="background: rgba(255,255,255,0.05);">
                                    <span class="status-badge status-${order.status}">${order.status}</span>
                                </div>
                            </div>
                            <div class="admin-form-group">
                                <label>Payment Method</label>
                                <div class="form-input" style="background: rgba(255,255,255,0.05);">${order.payment_method}</div>
                            </div>
                        </div>
                        
                        <div class="admin-form-group">
                            <label>Customer Information</label>
                            <div class="form-input" style="background: rgba(255,255,255,0.05); min-height: auto; padding: 15px;">
                                <strong>${order.customer_name}</strong><br>
                                ${order.customer_email}<br>
                                ${order.customer_phone}<br>
                                ${order.shipping_address}
                            </div>
                        </div>
                        
                        <div class="admin-form-group">
                            <label>Order Items</label>
                            <div style="background: rgba(255,255,255,0.05); border-radius: 8px; padding: 15px; margin-top: 10px;">
                                ${orderItems.map(item => `
                                    <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                        <div>
                                            <strong>${item.product_name}</strong><br>
                                            <small>Quantity: ${item.quantity}  R${parseFloat(item.price).toFixed(2)}</small>
                                        </div>
                                        <div>R${(parseFloat(item.price) * parseInt(item.quantity)).toFixed(2)}</div>
                                    </div>
                                `).join('')}
                                <div style="display: flex; justify-content: space-between; padding: 15px 0; font-size: 1.2rem; font-weight: bold;">
                                    <div>Total</div>
                                    <div>R${parseFloat(order.total_amount).toFixed(2)}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="admin-actions" style="margin-top: 30px;">
                            <button class="glass-button" id="updateOrderStatusBtn" style="background: rgba(40, 167, 69, 0.3);">
                                <i class="fas fa-sync-alt"></i> Update Status
                            </button>
                            <button class="glass-button" id="sendOrderEmailBtn">
                                <i class="fas fa-envelope"></i> Send Email
                            </button>
                        </div>
                    </div>
                `;
                
                document.getElementById('orderDetailsContent').innerHTML = orderDetailsHTML;
                
                // Add event listeners to buttons
                document.getElementById('updateOrderStatusBtn').addEventListener('click', () => updateOrderStatus(orderId));
                document.getElementById('sendOrderEmailBtn').addEventListener('click', () => sendOrderEmail(orderId));
                
                // Show modal
                document.getElementById('orderDetailsModal').classList.add('active');
                
            } catch (error) {
                console.error('Error loading order details:', error);
                showNotification('Error loading order details', 'error');
            }
        }
        
        async function updateOrderStatus(orderId) {
            const newStatus = prompt('Enter new status (pending, processing, completed, cancelled):');
            
            if (!newStatus || !['pending', 'processing', 'completed', 'cancelled'].includes(newStatus)) {
                showNotification('Invalid status', 'error');
                return;
            }
            
            try {
                const { error } = await supabase
                    .from('orders')
                    .update({ status: newStatus, updated_at: new Date().toISOString() })
                    .eq('id', orderId);
                
                if (error) throw error;
                
                // Refresh orders
                await loadOrders();
                
                // Update order details if modal is open
                viewOrderDetails(orderId);
                
                showNotification('Order status updated', 'success');
                
            } catch (error) {
                console.error('Error updating order status:', error);
                showNotification('Error updating order status', 'error');
            }
        }
        
        async function editOrder(orderId) {
            // For now, just view the order details
            viewOrderDetails(orderId);
        }
        
        function sendOrderEmail(orderId) {
            // This would integrate with an email service
            alert(`This would send an email update for order #${orderId}. In a production environment, this would connect to an email service like SendGrid or Mailchimp.`);
        }
        
        function printOrder() {
            window.print();
        }
        
        function exportOrders() {
            // Create CSV content
            let csvContent = "Order ID,Customer,Date,Amount,Status,Payment Method\n";
            
            orders.forEach(order => {
                csvContent += `#${order.id},"${order.customer_name || ''}",${new Date(order.created_at).toLocaleDateString()},R${parseFloat(order.total_amount || 0).toFixed(2)},${order.status},${order.payment_method}\n`;
            });
            
            // Create download link
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `orders_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showNotification('Orders exported successfully', 'success');
        }
        
        // ============ SETTINGS FUNCTIONS ============
        async function saveSettings() {
            try {
                const settings = {
                    store_name: document.getElementById('storeName').value,
                    store_email: document.getElementById('storeEmail').value,
                    store_phone: document.getElementById('storePhone').value,
                    currency: document.getElementById('storeCurrency').value,
                    shipping_cost: parseFloat(document.getElementById('shippingCost').value),
                    tax_rate: parseFloat(document.getElementById('taxRate').value),
                    store_description: document.getElementById('storeDescription').value,
                    updated_at: new Date().toISOString()
                };
                
                // Save settings to Supabase
                const { error } = await supabase
                    .from('store_settings')
                    .upsert([settings], { onConflict: 'id' });
                
                if (error) throw error;
                
                showNotification('Settings saved successfully', 'success');
                
            } catch (error) {
                console.error('Error saving settings:', error);
                showNotification('Error saving settings', 'error');
            }
        }
        
        async function updateAdminAccount() {
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            const confirmPassword = document.getElementById('adminConfirmPassword').value;
            
            if (password && password !== confirmPassword) {
                showNotification('Passwords do not match', 'error');
                return;
            }
            
            try {
                // Update admin email if provided
                if (email) {
                    const { error: emailError } = await supabase.auth.updateUser({ email });
                    if (emailError) throw emailError;
                }
                
                // Update password if provided
                if (password) {
                    const { error: passwordError } = await supabase.auth.updateUser({ password });
                    if (passwordError) throw passwordError;
                }
                
                // Clear form
                document.getElementById('adminEmail').value = '';
                document.getElementById('adminPassword').value = '';
                document.getElementById('adminConfirmPassword').value = '';
                
                showNotification('Admin account updated successfully', 'success');
                
            } catch (error) {
                console.error('Error updating admin account:', error);
                showNotification('Error updating admin account', 'error');
            }
        }
        
        // ============ ANALYTICS FUNCTIONS ============
        async function loadAnalytics() {
            // This would load chart data from Supabase
            // For now, show a placeholder
            document.getElementById('revenueChart').innerHTML = `
                <div class="admin-empty-state">
                    <i class="fas fa-chart-line"></i>
                    <h5>Analytics Dashboard</h5>
                    <p>Revenue and product analytics will be displayed here.</p>
                    <p><small>Connect to a charting library like Chart.js for visualizations.</small></p>
                </div>
            `;
            
            document.getElementById('productsChart').innerHTML = `
                <div class="admin-empty-state">
                    <i class="fas fa-chart-pie"></i>
                    <h5>Product Analytics</h5>
                    <p>Top products and sales performance will be displayed here.</p>
                </div>
            `;
        }
        
        // ============ UTILITY FUNCTIONS ============
        function showNotification(message, type = 'info') {
            const notificationsContainer = document.getElementById('adminNotifications');
            
            const notification = document.createElement('div');
            notification.className = 'admin-notification';
            
            let icon = 'fas fa-info-circle';
            if (type === 'success') icon = 'fas fa-check-circle';
            if (type === 'error') icon = 'fas fa-exclamation-circle';
            if (type === 'warning') icon = 'fas fa-exclamation-triangle';
            
            notification.innerHTML = `
                <i class="${icon}"></i>
                <div class="admin-notification-content">
                    <h6>${type.charAt(0).toUpperCase() + type.slice(1)}</h6>
                    <p>${message}</p>
                </div>
                <button class="admin-notification-close">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            notificationsContainer.appendChild(notification);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }
            }, 5000);
            
            // Close button
            notification.querySelector('.admin-notification-close').addEventListener('click', () => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            });
        }
        
        function updatePagination(containerId, currentPage, totalPages, callback) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            // Previous button
            const prevButton = document.createElement('button');
            prevButton.className = `admin-page-btn ${currentPage === 1 ? 'disabled' : ''}`;
            prevButton.innerHTML = '<i class="fas fa-chevron-left"></i> Previous';
            prevButton.addEventListener('click', () => {
                if (currentPage > 1) {
                    callback(currentPage - 1);
                }
            });
            container.appendChild(prevButton);
            
            // Page numbers
            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(totalPages, startPage + 4);
            
            for (let i = startPage; i <= endPage; i++) {
                const pageButton = document.createElement('button');
                pageButton.className = `admin-page-btn ${i === currentPage ? 'active' : ''}`;
                pageButton.textContent = i;
                pageButton.addEventListener('click', () => {
                    callback(i);
                });
                container.appendChild(pageButton);
            }
            
            // Next button
            const nextButton = document.createElement('button');
            nextButton.className = `admin-page-btn ${currentPage === totalPages ? 'disabled' : ''}`;
            nextButton.innerHTML = 'Next <i class="fas fa-chevron-right"></i>';
            nextButton.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    callback(currentPage + 1);
                }
            });
            container.appendChild(nextButton);
        }
        
        // ============ EXISTING FUNCTIONALITY ============
        // This section contains all the original functionality from your code
        // I've kept it intact and only added the Supabase integration on top
        
        // DOM Elements
        const navbar = document.getElementById('navbar');
        const fadeElements = document.querySelectorAll('.fade-in');
        const startQualificationBtn = document.querySelector('.start-qualification');
        const wizardSteps = document.querySelectorAll('.wizard-step');
        const optionItems = document.querySelectorAll('.option-item');
        const wizardNextBtns = document.querySelectorAll('.wizard-next');
        const wizardPrevBtns = document.querySelectorAll('.wizard-prev');
        const progressBar = document.getElementById('progressBar');
        const resultsModal = document.getElementById('resultsModal');
        const closeResultsBtn = document.getElementById('closeResults');
        const closeResultsBtn2 = document.getElementById('closeResultsBtn');
        const addAllToCartBtn = document.getElementById('addAllToCart');
        const galleryTrack = document.getElementById('galleryTrack');
        const galleryDots = document.querySelectorAll('.gallery-dot');
        
        // Search elements
        const searchIcon = document.getElementById('searchIcon');
        const searchInput = document.getElementById('searchInput');
        const searchClose = document.getElementById('searchClose');
        const searchResults = document.getElementById('searchResults');
        
        // New search overlay elements
        const searchOverlay = document.getElementById('searchOverlay');
        const searchOverlayInput = document.getElementById('searchOverlayInput');
        const searchOverlayResults = document.getElementById('searchOverlayResults');
        const searchBackBtn = document.getElementById('searchBackBtn');
        
        // Cart elements
        const floatingCartBtn = document.getElementById('floatingCartBtn');
        const floatingCartBadge = document.getElementById('floatingCartBadge');
        const cartModal = document.getElementById('cartModal');
        const closeCartBtn = document.getElementById('closeCart');
        const cartItems = document.getElementById('cartItems');
        const cartSummary = document.getElementById('cartSummary');
        const checkoutBtn = document.getElementById('checkoutBtn');
        
        // Close buttons
        const closeAuthBtn = document.getElementById('closeAuth');
        const closeWizardBtn = document.getElementById('closeWizard');
        const closeCheckoutBtn = document.getElementById('closeCheckout');
        const closeSuccessBtn = document.getElementById('closeSuccess');
        
        // Checkout elements
        const checkoutModal = document.getElementById('checkoutModal');
        const checkoutSteps = document.querySelectorAll('.checkout-step');
        const checkoutForms = document.querySelectorAll('.checkout-form');
        const shippingForm = document.getElementById('shippingForm');
        const paymentForm = document.getElementById('paymentForm');
        const reviewForm = document.getElementById('reviewForm');
        const backToCartBtn = document.getElementById('backToCart');
        const nextToPaymentBtn = document.getElementById('nextToPayment');
        const backToShippingBtn = document.getElementById('backToShipping');
        const nextToReviewBtn = document.getElementById('nextToReview');
        const backToPaymentBtn2 = document.getElementById('backToPayment');
        const placeOrderBtn = document.getElementById('placeOrderBtn');
        const paymentMethods = document.querySelectorAll('.payment-method');
        
        // Success modal elements
        const successModal = document.getElementById('successModal');
        const continueShoppingBtn = document.getElementById('continueShopping');
        
        // Mobile menu elements
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenuBtnIcon = document.querySelector('#mobileMenuBtn i');
        const mobileMenuOverlay = document.getElementById('mobileMenuOverlay');
        const mobileNavLinks = document.getElementById('mobileNavLinks');
        const mobileMenuClose = document.getElementById('mobileMenuClose');
        const mobileNavLinksItems = document.querySelectorAll('.mobile-nav-link');
        
        // User data for qualification
        const userData = {
            skinConcern: '',
            sensitivity: '',
            ageRange: ''
        };
        
        // Personalized recommendations for current user
        let personalizedRecommendations = [];
        
        // Current wizard step
        let currentStep = 1;
        const totalSteps = 3;
        
        // Gallery state
        let currentGallerySlide = 0;
        const gallerySlideCount = 5;
        
        // Cart state
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        
        // Checkout state
        let currentCheckoutStep = 1;
        let selectedPaymentMethod = 'credit';
        
        // Mobile menu state
        let isMobileMenuOpen = false;
        
        // Search state
        let currentSearchCategory = 'all';
        let searchTimeout = null;
        
        // NEW: Address Selection State with manual entry support
        let currentAddressStep = 'country';
        let selectedCountry = '';
        let selectedState = '';
        let selectedCity = '';
        let selectedVillage = '';
        let selectedZip = '';
        let isManualEntry = false;
        let manualState = '';
        let manualCity = '';
        let manualVillage = '';
        let manualZip = '';
        
        // Address data structure (mock data for demonstration) - MODIFIED: Only South Africa and United States
        const addressData = {
            countries: [
                { code: 'ZA', name: 'South Africa', flag: '', currency: 'ZAR' },
                { code: 'US', name: 'United States', flag: '', currency: 'USD' },
                { code: 'OTHER', name: 'Other Country', flag: '', currency: 'USD' }
            ],
            states: {
                'ZA': [
                    'Gauteng', 'Western Cape', 'KwaZulu-Natal', 'Eastern Cape', 
                    'Limpopo', 'Mpumalanga', 'North West', 'Free State', 'Northern Cape'
                ],
                'US': [
                    'California', 'Texas', 'Florida', 'New York', 'Pennsylvania',
                    'Illinois', 'Ohio', 'Georgia', 'North Carolina', 'Michigan'
                ],
                'OTHER': []
            },
            cities: {
                'Gauteng': ['Johannesburg', 'Pretoria', 'Sandton', 'Randburg', 'Centurion'],
                'Western Cape': ['Cape Town', 'Stellenbosch', 'Paarl', 'Worcester', 'George'],
                'California': ['Los Angeles', 'San Francisco', 'San Diego', 'Sacramento', 'San Jose'],
                'Texas': ['Houston', 'Dallas', 'Austin', 'San Antonio', 'Fort Worth'],
                'OTHER': []
            },
            villages: {
                'Johannesburg': ['Sandton CBD', 'Randburg CBD', 'Rosebank', 'Parktown', 'Melville'],
                'Cape Town': ['City Bowl', 'Atlantic Seaboard', 'Southern Suburbs', 'Northern Suburbs'],
                'Los Angeles': ['Hollywood', 'Downtown LA', 'Beverly Hills', 'Santa Monica', 'Venice'],
                'OTHER': []
            },
            zipCodes: {
                'Johannesburg': ['2000', '2001', '2196', '2193', '2194'],
                'Cape Town': ['8000', '8001', '7700', '7800', '7925'],
                'Los Angeles': ['90001', '90002', '90003', '90004', '90005'],
                'OTHER': []
            }
        };
        
        // Initialize cart badge
        updateCartBadge();
        
        // Initialize address selection
        initializeAddressSelection();
        
        // Initialize existing functionality
        function initializeExistingFunctionality() {
            // Floating cart functionality
            floatingCartBtn.addEventListener('click', () => {
                cartModal.classList.add('active');
                updateCartDisplay();
            });
            
            // Mobile menu functionality
            mobileMenuBtn.addEventListener('click', () => {
                if (isMobileMenuOpen) {
                    closeMobileMenu();
                } else {
                    openMobileMenu();
                }
            });
            
            mobileMenuClose.addEventListener('click', () => {
                closeMobileMenu();
            });
            
            mobileMenuOverlay.addEventListener('click', () => {
                closeMobileMenu();
            });
            
            mobileNavLinksItems.forEach(link => {
                link.addEventListener('click', () => {
                    closeMobileMenu();
                });
            });
            
            // Close buttons functionality
            closeAuthBtn.addEventListener('click', () => {
                document.getElementById('authModal').classList.remove('active');
            });
            
            closeWizardBtn.addEventListener('click', () => {
                wizardSteps.forEach(step => step.classList.remove('active'));
                wizardSteps[0].classList.add('active');
                currentStep = 1;
                updateProgressBar();
                
                optionItems.forEach(item => item.classList.remove('selected'));
                userData.skinConcern = '';
                userData.sensitivity = '';
                userData.ageRange = '';
            });
            
            closeCartBtn.addEventListener('click', () => {
                cartModal.classList.remove('active');
            });
            
            closeCheckoutBtn.addEventListener('click', () => {
                checkoutModal.classList.remove('active');
                resetAddressSelection();
            });
            
            closeSuccessBtn.addEventListener('click', () => {
                successModal.classList.remove('active');
            });
            
            closeResultsBtn.addEventListener('click', () => {
                resultsModal.classList.remove('active');
            });
            
            closeResultsBtn2.addEventListener('click', () => {
                resultsModal.classList.remove('active');
            });
            
            // Add all recommended products to cart
            addAllToCartBtn.addEventListener('click', () => {
                if (personalizedRecommendations.length === 0) {
                    alert('No recommendations to add to cart');
                    return;
                }
                
                personalizedRecommendations.forEach(productId => {
                    const product = allProducts.find(p => p.id === productId);
                    if (product) {
                        addToCart({
                            id: product.id,
                            name: product.name,
                            price: product.price,
                            image: product.image_url
                        });
                    }
                });
                
                addAllToCartBtn.innerHTML = '<i class="fas fa-check"></i> All Added!';
                addAllToCartBtn.style.background = 'rgba(40, 167, 69, 0.3)';
                
                setTimeout(() => {
                    addAllToCartBtn.innerHTML = '<i class="fas fa-shopping-cart"></i> Add All to Cart';
                    addAllToCartBtn.style.background = '';
                }, 2000);
                
                setTimeout(() => {
                    resultsModal.classList.remove('active');
                    cartModal.classList.add('active');
                }, 500);
            });
            
            // Enhanced Search functionality
            searchIcon.addEventListener('click', () => {
                if (window.innerWidth <= 768) {
                    searchOverlay.classList.add('active');
                    searchOverlayInput.focus();
                    document.body.style.overflow = 'hidden';
                    
                    if (!searchOverlayInput.value.trim()) {
                        displayTopSearchedProductsInOverlay();
                    }
                } else {
                    searchInput.classList.add('active');
                    searchClose.classList.add('active');
                    searchInput.focus();
                    
                    if (!searchInput.value.trim()) {
                        displayTopSearchedProducts();
                    }
                }
            });
            
            searchClose.addEventListener('click', () => {
                searchInput.classList.remove('active');
                searchClose.classList.remove('active');
                searchInput.value = '';
                searchResults.classList.remove('active');
            });
            
            searchInput.addEventListener('focus', () => {
                if (!searchInput.value.trim()) {
                    displayTopSearchedProducts();
                }
            });
            
            searchInput.addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                
                searchTimeout = setTimeout(() => {
                    const searchTerm = e.target.value.toLowerCase().trim();
                    
                    if (searchTerm.length === 0) {
                        displayTopSearchedProducts();
                        return;
                    }
                    
                    performSearch(searchTerm, searchResults);
                }, 300);
            });
            
            // Search overlay functionality
            searchBackBtn.addEventListener('click', () => {
                searchOverlay.classList.remove('active');
                searchOverlayInput.value = '';
                document.body.style.overflow = '';
            });
            
            searchOverlayInput.addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                
                searchTimeout = setTimeout(() => {
                    const searchTerm = e.target.value.toLowerCase().trim();
                    
                    if (searchTerm.length === 0) {
                        displayTopSearchedProductsInOverlay();
                        return;
                    }
                    
                    performSearch(searchTerm, searchOverlayResults);
                }, 300);
            });
            
            // Scroll event for navbar and fade animations
            window.addEventListener('scroll', () => {
                if (window.scrollY > 50) {
                    navbar.classList.add('scrolled');
                } else {
                    navbar.classList.remove('scrolled');
                }
                
                fadeElements.forEach(element => {
                    const elementTop = element.getBoundingClientRect().top;
                    const windowHeight = window.innerHeight;
                    
                    if (elementTop < windowHeight - 100) {
                        element.classList.add('visible');
                    }
                });
                
                const video = document.getElementById('background-video');
                const scrolled = window.pageYOffset;
                const rate = scrolled * -0.5;
                video.style.transform = `translate3d(0px, ${rate}px, 0px)`;
            });
            
            // Initialize fade elements on page load
            fadeElements.forEach(element => {
                const elementTop = element.getBoundingClientRect().top;
                const windowHeight = window.innerHeight;
                
                if (elementTop < windowHeight - 100) {
                    element.classList.add('visible');
                }
            });
            
            updateProgressBar();
            
            if ('ontouchstart' in window) {
                document.body.classList.add('touch-device');
                
                document.querySelectorAll('.glass-button, .option-item, .product-card').forEach(element => {
                    element.style.cursor = 'pointer';
                });
            }
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes pulse {
                    0% { box-shadow: 0 0 0 0 rgba(196, 167, 125, 0.4); }
                    70% { box-shadow: 0 0 0 15px rgba(196, 167, 125, 0); }
                    100% { box-shadow: 0 0 0 0 rgba(196, 167, 125, 0); }
                }
            `;
            document.head.appendChild(style);
            
            initializeFlagshipProduct();
            
            initializeAddToCartButtons();
            
            // Initialize payment method forms
            initializePaymentForms();
            
            // Generate dynamic reference for bank transfer
            generateBankReference();
            
            // Start qualification wizard
            startQualificationBtn.addEventListener('click', () => {
                document.getElementById('qualification').scrollIntoView({ behavior: 'smooth' });
            });
            
            // Option selection in wizard
            optionItems.forEach(item => {
                item.addEventListener('click', function() {
                    const parentStep = this.closest('.wizard-step');
                    const allOptions = parentStep.querySelectorAll('.option-item');
                    allOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    this.classList.add('selected');
                    
                    const stepId = parentStep.id;
                    const value = this.getAttribute('data-value');
                    
                    if (stepId === 'step1') {
                        userData.skinConcern = value;
                    } else if (stepId === 'step2') {
                        userData.sensitivity = value;
                    } else if (stepId === 'step3') {
                        userData.ageRange = value;
                    }
                });
            });
            
            // Wizard navigation
            wizardNextBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const step = parseInt(this.getAttribute('data-step'));
                    
                    if (step === 1 && !userData.skinConcern) {
                        alert('Please select your primary skin concern');
                        return;
                    } else if (step === 2 && !userData.sensitivity) {
                        alert('Please select your skin sensitivity level');
                        return;
                    } else if (step === 3 && !userData.ageRange) {
                        alert('Please select your age range');
                        return;
                    }
                    
                    if (step === 3) {
                        generatePersonalizedRecommendations();
                        return;
                    }
                    
                    if (currentStep < totalSteps) {
                        wizardSteps[currentStep - 1].classList.remove('active');
                        currentStep++;
                        wizardSteps[currentStep - 1].classList.add('active');
                        updateProgressBar();
                    }
                });
            });
            
            wizardPrevBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    if (currentStep > 1) {
                        wizardSteps[currentStep - 1].classList.remove('active');
                        currentStep--;
                        wizardSteps[currentStep - 1].classList.add('active');
                        updateProgressBar();
                    }
                });
            });
            
            // Gallery navigation
            galleryDots.forEach(dot => {
                dot.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    goToGallerySlide(index);
                });
            });
            
            // Auto-rotate gallery
            setInterval(() => {
                currentGallerySlide = (currentGallerySlide + 1) % gallerySlideCount;
                goToGallerySlide(currentGallerySlide);
            }, 5000);
            
            // Smooth scrolling for anchor links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                        
                        closeMobileMenu();
                    }
                });
            });
            
            // Newsletter form
            const newsletterForm = document.querySelector('.newsletter-form');
            const newsletterInput = newsletterForm.querySelector('input');
            const newsletterButton = newsletterForm.querySelector('button');
            
            newsletterButton.addEventListener('click', () => {
                if (newsletterInput.value && newsletterInput.value.includes('@')) {
                    newsletterButton.innerHTML = '<i class="fas fa-check"></i> Subscribed!';
                    newsletterButton.style.background = 'rgba(40, 167, 69, 0.3)';
                    newsletterInput.value = '';
                    
                    setTimeout(() => {
                        newsletterButton.innerHTML = 'Subscribe';
                        newsletterButton.style.background = '';
                    }, 3000);
                } else {
                    newsletterInput.style.border = '1px solid rgba(220, 53, 69, 0.5)';
                    setTimeout(() => {
                        newsletterInput.style.border = '';
                    }, 2000);
                }
            });
            
            // Checkout functionality
            checkoutBtn.addEventListener('click', () => {
                if (cart.length === 0) {
                    alert('Your cart is empty!');
                    return;
                }
                
                cartModal.classList.remove('active');
                checkoutModal.classList.add('active');
                updateCheckoutStep(1);
                
                initializeAddressSelection();
                generateBankReference(); // Generate new reference for each checkout
            });
            
            checkoutModal.addEventListener('click', (e) => {
                if (e.target === checkoutModal) {
                    checkoutModal.classList.remove('active');
                    resetAddressSelection();
                }
            });
            
            // Checkout navigation - UPDATED FOR ADDRESS VALIDATION
            nextToPaymentBtn.addEventListener('click', () => {
                if (!validateAddressSelection()) {
                    alert('Please complete the address selection process before proceeding');
                    return;
                }
                
                if (!validateShippingForm()) {
                    alert('Please fill in all required shipping information');
                    return;
                }
                
                updateCheckoutStep(2);
            });
            
            backToShippingBtn.addEventListener('click', () => {
                updateCheckoutStep(1);
            });
            
            nextToReviewBtn.addEventListener('click', () => {
                if (selectedPaymentMethod === 'credit' && !validatePaymentForm()) {
                    alert('Please fill in all required payment information');
                    return;
                }
                
                updateCheckoutStep(3);
            });
            
            backToPaymentBtn2.addEventListener('click', () => {
                updateCheckoutStep(2);
            });
            
            backToCartBtn.addEventListener('click', () => {
                checkoutModal.classList.remove('active');
                cartModal.classList.add('active');
            });
            
            // Place order
            placeOrderBtn.addEventListener('click', async () => {
                if (!document.getElementById('agreeTermsCheckout').checked) {
                    alert('Please agree to the Terms & Conditions');
                    return;
                }
                
                if (!validateAddressSelection()) {
                    alert('Please complete the address selection process');
                    return;
                }
                
                // For credit card, validate payment form
                if (selectedPaymentMethod === 'credit' && !validatePaymentForm()) {
                    alert('Please fill in all required payment information');
                    return;
                }
                
                const orderId = Math.floor(1000 + Math.random() * 9000);
                document.getElementById('orderId').textContent = orderId;
                
                // Create order object
                const order = {
                    order_number: `LFA-${orderId}`,
                    customer_name: `${document.getElementById('shippingFirstName').value} ${document.getElementById('shippingLastName').value}`,
                    customer_email: document.getElementById('shippingEmail').value,
                    customer_phone: document.getElementById('shippingPhone').value,
                    shipping_address: {
                        country: selectedCountry,
                        state: selectedState || manualState,
                        city: selectedCity || manualCity,
                        village: selectedVillage || manualVillage,
                        zip: selectedZip || manualZip,
                        street: document.getElementById('shippingAddress').value,
                        apartment: document.getElementById('shippingApartment').value,
                        notes: document.getElementById('shippingNotes').value,
                        isManualEntry: isManualEntry
                    },
                    items: cart.map(item => ({
                        product_id: item.id,
                        product_name: item.name,
                        price: item.price,
                        quantity: item.quantity,
                        image_url: item.image
                    })),
                    subtotal: parseFloat(document.getElementById('reviewSubtotal').textContent.replace('R', '')),
                    shipping: parseFloat(document.getElementById('reviewShipping').textContent.replace('R', '')),
                    tax: parseFloat(document.getElementById('reviewTax').textContent.replace('R', '')),
                    total_amount: parseFloat(document.getElementById('reviewTotal').textContent.replace('R', '')),
                    payment_method: selectedPaymentMethod,
                    status: selectedPaymentMethod === 'bank' ? 'pending' : 'processing',
                    notes: document.getElementById('orderNotes').value,
                    reference: selectedPaymentMethod === 'bank' ? document.getElementById('bankReference').textContent : null
                };
                
                try {
                    // Save order to Supabase
                    const { data: savedOrder, error } = await supabase
                        .from('orders')
                        .insert([{
                            order_number: order.order_number,
                            customer_name: order.customer_name,
                            customer_email: order.customer_email,
                            customer_phone: order.customer_phone,
                            shipping_address: JSON.stringify(order.shipping_address),
                            items: JSON.stringify(order.items),
                            subtotal: order.subtotal,
                            shipping: order.shipping,
                            tax: order.tax,
                            total_amount: order.total_amount,
                            payment_method: order.payment_method,
                            status: order.status,
                            notes: order.notes,
                            reference: order.reference,
                            created_at: new Date().toISOString()
                        }])
                        .select()
                        .single();
                    
                    if (error) throw error;
                    
                    // Save order items to Supabase
                    const orderItems = order.items.map(item => ({
                        order_id: savedOrder.id,
                        product_id: item.product_id,
                        product_name: item.product_name,
                        price: item.price,
                        quantity: item.quantity,
                        image_url: item.image_url
                    }));
                    
                    const { error: itemsError } = await supabase
                        .from('order_items')
                        .insert(orderItems);
                    
                    if (itemsError) throw itemsError;
                    
                    // Update product sales counts
                    for (const item of order.items) {
                        const { error: updateError } = await supabase
                            .from('products')
                            .update({ 
                                sales_count: supabase.sql`sales_count + ${item.quantity}`,
                                stock_quantity: supabase.sql`stock_quantity - ${item.quantity}`
                            })
                            .eq('id', item.product_id);
                        
                        if (updateError) console.error('Error updating product sales:', updateError);
                    }
                    
                    // Save or update customer
                    const { error: customerError } = await supabase
                        .from('customers')
                        .upsert({
                            email: order.customer_email,
                            full_name: order.customer_name,
                            phone: order.customer_phone,
                            last_order_date: new Date().toISOString(),
                            order_count: supabase.sql`order_count + 1`,
                            total_spent: supabase.sql`total_spent + ${order.total_amount}`,
                            status: 'active',
                            updated_at: new Date().toISOString()
                        }, {
                            onConflict: 'email'
                        });
                    
                    if (customerError) console.error('Error saving customer:', customerError);
                    
                    // Clear cart
                    cart = [];
                    localStorage.setItem('cart', JSON.stringify(cart));
                    updateCartBadge();
                    
                    // Show success modal
                    checkoutModal.classList.remove('active');
                    successModal.classList.add('active');
                    
                    // Reset address selection
                    resetAddressSelection();
                    
                    // Refresh admin data if admin is logged in
                    if (isAdmin) {
                        loadAdminData();
                    }
                    
                } catch (error) {
                    console.error('Error saving order:', error);
                    alert('Error saving order. Please try again.');
                }
            });
            
            // Continue shopping
            continueShoppingBtn.addEventListener('click', () => {
                successModal.classList.remove('active');
            });
        }
        
        // Mobile menu functions
        function openMobileMenu() {
            mobileMenuOverlay.classList.add('active');
            mobileNavLinks.classList.add('active');
            isMobileMenuOpen = true;
            document.body.style.overflow = 'hidden';
            mobileMenuBtnIcon.classList.remove('fa-bars');
            mobileMenuBtnIcon.classList.add('fa-times');
            mobileMenuBtn.classList.add('active');
        }
        
        function closeMobileMenu() {
            mobileMenuOverlay.classList.remove('active');
            mobileNavLinks.classList.remove('active');
            isMobileMenuOpen = false;
            document.body.style.overflow = '';
            mobileMenuBtnIcon.classList.remove('fa-times');
            mobileMenuBtnIcon.classList.add('fa-bars');
            mobileMenuBtn.classList.remove('active');
        }
        
        // Update progress bar
        function updateProgressBar() {
            const progress = ((currentStep - 1) / (totalSteps - 1)) * 100;
            progressBar.style.width = `${progress}%`;
        }
        
        // Generate personalized recommendations based on user data
        function generatePersonalizedRecommendations() {
            // For now, show some sample recommendations
            personalizedRecommendations = allProducts.slice(0, 3).map(p => p.id);
            
            showResults("Based on your skin profile, we recommend our best-selling products to address your concerns and deliver radiant results.", personalizedRecommendations);
        }
        
        // Show results modal with personalized recommendations
        function showResults(description, productIds) {
            document.getElementById('resultDescription').textContent = description;
            
            const personalizedProductsDiv = document.getElementById('personalizedProducts');
            personalizedProductsDiv.innerHTML = '';
            
            productIds.forEach(productId => {
                const product = allProducts.find(p => p.id === productId);
                if (product) {
                    let detailsHTML = '';
                    if (product.benefits || product.usage || product.ingredients) {
                        detailsHTML = `
                            <div class="product-details">
                                ${product.benefits ? `<div class="product-benefits"><strong>Benefits:</strong> ${product.benefits}</div>` : ''}
                                ${product.usage ? `<div class="product-usage"><strong>Usage:</strong> ${product.usage}</div>` : ''}
                                ${product.ingredients ? `<div class="product-ingredients"><strong>Active Ingredients:</strong> ${product.ingredients}</div>` : ''}
                            </div>
                        `;
                    }
                    
                    const productHTML = `
                        <div class="product-card glass-card">
                            ${product.badge ? `<div class="product-badge badge-${product.badge}">${product.badge}</div>` : ''}
                            <div class="product-image" style="background-image: url('${product.image_url}');"></div>
                            <div class="product-info">
                                <h3>${product.name}</h3>
                                <p>${product.description.substring(0, 100)}...</p>
                                ${detailsHTML}
                                <div class="product-price">R${parseFloat(product.price).toFixed(2)}</div>
                            </div>
                            <button class="glass-button add-to-cart-btn" 
                                data-id="${product.id}" 
                                data-name="${product.name}" 
                                data-price="${product.price}" 
                                data-image="${product.image_url}">
                                <i class="fas fa-cart-plus"></i> Add to Cart
                            </button>
                        </div>
                    `;
                    personalizedProductsDiv.innerHTML += productHTML;
                }
            });
            
            personalizedProductsDiv.querySelectorAll('.add-to-cart-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-id'));
                    const productName = this.getAttribute('data-name');
                    const productPrice = parseFloat(this.getAttribute('data-price'));
                    const productImage = this.getAttribute('data-image');
                    
                    addToCart({
                        id: productId,
                        name: productName,
                        price: productPrice,
                        image: productImage
                    });
                    
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i> Added!';
                    this.style.background = 'rgba(40, 167, 69, 0.3)';
                    
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.style.background = '';
                    }, 2000);
                });
            });
            
            resultsModal.classList.add('active');
            
            setTimeout(() => {
                resultsModal.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }
        
        function goToGallerySlide(index) {
            currentGallerySlide = index;
            const translateX = -index * 325;
            
            galleryTrack.style.transform = `translateX(${translateX}px)`;
            
            galleryDots.forEach((dot, i) => {
                if (i === index) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });
        }
        
        // Cart functionality
        function updateCartBadge() {
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            
            if (totalItems > 0) {
                floatingCartBadge.textContent = totalItems;
                floatingCartBadge.style.display = 'flex';
            } else {
                floatingCartBadge.style.display = 'none';
            }
        }
        
        // Initialize all add to cart buttons
        function initializeAddToCartButtons() {
            document.querySelectorAll('.add-to-cart').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-id'));
                    const productName = this.getAttribute('data-name');
                    const productPrice = parseFloat(this.getAttribute('data-price'));
                    const productImage = this.getAttribute('data-image');
                    
                    addToCart({
                        id: productId,
                        name: productName,
                        price: productPrice,
                        image: productImage
                    });
                    
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i> Added!';
                    this.style.background = 'rgba(40, 167, 69, 0.3)';
                    
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.style.background = '';
                    }, 2000);
                });
            });
        }
        
        // Add item to cart
        function addToCart(product) {
            const existingItem = cart.find(item => item.id === product.id);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    ...product,
                    quantity: 1
                });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            
            updateCartBadge();
            
            if (cartModal.classList.contains('active')) {
                updateCartDisplay();
            }
        }
        
        // Update cart display - CLEANER DESIGN
        function updateCartDisplay() {
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="cart-empty">
                        <i class="fas fa-shopping-bag"></i>
                        <h4>Your bag is empty</h4>
                        <p>Add some products to get started!</p>
                        <button class="glass-button" onclick="document.querySelector('#all-products').scrollIntoView({behavior: 'smooth'})">
                            <i class="fas fa-store"></i> Browse Products
                        </button>
                    </div>
                `;
                cartSummary.style.display = 'none';
                return;
            }
            
            let itemsHTML = '';
            let subtotal = 0;
            
            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                
                itemsHTML += `
                    <div class="cart-item glass-card">
                        <div class="cart-item-image" style="background-image: url('${item.image}');"></div>
                        <div class="cart-item-info">
                            <h4>${item.name}</h4>
                            <div class="cart-item-price">R${item.price.toFixed(2)} each</div>
                            <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem;">
                                Total: R${itemTotal.toFixed(2)}
                            </div>
                        </div>
                        <div class="cart-item-actions">
                            <div class="quantity-control">
                                <button class="quantity-btn decrease-quantity" data-index="${index}">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="quantity">${item.quantity}</span>
                                <button class="quantity-btn increase-quantity" data-index="${index}">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                            <button class="remove-item" data-index="${index}">
                                <i class="fas fa-trash"></i> Remove
                            </button>
                        </div>
                    </div>
                `;
            });
            
            cartItems.innerHTML = itemsHTML;
            
            const shipping = 50.00;
            const total = subtotal + shipping;
            
            document.getElementById('cartSubtotal').textContent = `R${subtotal.toFixed(2)}`;
            document.getElementById('cartShipping').textContent = `R${shipping.toFixed(2)}`;
            document.getElementById('cartTax').textContent = `R0.00`;
            document.getElementById('cartTotal').textContent = `R${total.toFixed(2)}`;
            
            cartSummary.style.display = 'block';
            
            document.querySelectorAll('.decrease-quantity').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    updateQuantity(index, -1);
                });
            });
            
            document.querySelectorAll('.increase-quantity').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    updateQuantity(index, 1);
                });
            });
            
            document.querySelectorAll('.remove-item').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    removeFromCart(index);
                });
            });
        }
        
        // Update item quantity
        function updateQuantity(index, change) {
            if (cart[index]) {
                cart[index].quantity += change;
                
                if (cart[index].quantity <= 0) {
                    cart.splice(index, 1);
                }
                
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartBadge();
                updateCartDisplay();
            }
        }
        
        // Remove item from cart
        function removeFromCart(index) {
            if (cart[index]) {
                cart.splice(index, 1);
                
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartBadge();
                updateCartDisplay();
            }
        }
        
        // Update checkout step
        function updateCheckoutStep(step) {
            currentCheckoutStep = step;
            
            checkoutSteps.forEach(s => {
                s.classList.remove('active', 'completed');
                
                const stepNum = parseInt(s.getAttribute('data-step'));
                
                if (stepNum === step) {
                    s.classList.add('active');
                } else if (stepNum < step) {
                    s.classList.add('completed');
                }
            });
            
            checkoutForms.forEach(form => {
                form.classList.remove('active');
            });
            
            if (step === 1) {
                shippingForm.classList.add('active');
            } else if (step === 2) {
                paymentForm.classList.add('active');
            } else if (step === 3) {
                updateReviewSection();
                reviewForm.classList.add('active');
            }
        }
        
        // Update review section
        function updateReviewSection() {
            const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            const shipping = 50.00;
            const total = subtotal + shipping;
            
            let reviewItemsHTML = '';
            cart.forEach(item => {
                reviewItemsHTML += `
                    <div class="review-item">
                        <span>${item.name}  ${item.quantity}</span>
                        <span>R${(item.price * item.quantity).toFixed(2)}</span>
                    </div>
                `;
            });
            
            document.getElementById('reviewItems').innerHTML = reviewItemsHTML;
            
            document.getElementById('reviewSubtotal').textContent = `R${subtotal.toFixed(2)}`;
            document.getElementById('reviewShipping').textContent = `R${shipping.toFixed(2)}`;
            document.getElementById('reviewTax').textContent = `R0.00`;
            document.getElementById('reviewTotal').textContent = `R${total.toFixed(2)}`;
        }
        
        // Validation functions
        function validateShippingForm() {
            const requiredFields = [
                'shippingFirstName',
                'shippingLastName',
                'shippingEmail',
                'shippingPhone',
                'shippingAddress'
            ];
            
            for (const fieldId of requiredFields) {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    return false;
                }
            }
            
            return true;
        }
        
        function validatePaymentForm() {
            if (selectedPaymentMethod !== 'credit') {
                return true;
            }
            
            const requiredFields = [
                'cardName',
                'cardNumber',
                'cardExpiry',
                'cardCVC'
            ];
            
            for (const fieldId of requiredFields) {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    return false;
                }
            }
            
            return true;
        }
        
        // Initialize payment method forms
        function initializePaymentForms() {
            // Set up payment method selection
            paymentMethods.forEach(method => {
                method.addEventListener('click', function() {
                    const methodType = this.getAttribute('data-method');
                    
                    paymentMethods.forEach(m => m.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    selectedPaymentMethod = methodType;
                    
                    // Hide all payment form sections
                    document.querySelectorAll('.payment-form-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    // Show the selected payment form section
                    document.getElementById(`${methodType}-form`).classList.add('active');
                    
                    // Set required fields for credit card
                    const cardFields = ['cardName', 'cardNumber', 'cardExpiry', 'cardCVC'];
                    cardFields.forEach(fieldId => {
                        const field = document.getElementById(fieldId);
                        if (field) {
                            field.required = (methodType === 'credit');
                        }
                    });
                });
            });
            
            // Set up copy buttons for bank details
            document.querySelectorAll('.copy-button').forEach(button => {
                button.addEventListener('click', function() {
                    const textToCopy = this.getAttribute('data-copy') || 
                                     document.querySelector(this.getAttribute('data-copy-target')).textContent;
                    
                    copyToClipboard(textToCopy);
                    
                    const originalText = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-check"></i> Copied!';
                    this.style.background = 'rgba(40, 167, 69, 0.3)';
                    
                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.style.background = '';
                    }, 2000);
                });
            });
            
            // Set up PayPal button
            document.getElementById('paypalCheckoutBtn').addEventListener('click', function() {
                // In a real implementation, this would redirect to PayPal
                // For now, we'll simulate a successful payment
                alert('You will be redirected to PayPal to complete your payment. In a real implementation, this would process through PayPal.');
                
                // Simulate successful PayPal payment
                setTimeout(() => {
                    // Move to review step
                    updateCheckoutStep(3);
                }, 1000);
            });
            
            // Copy reference button for bank transfer
            document.getElementById('copyReference').addEventListener('click', function() {
                const reference = document.getElementById('bankReference').textContent;
                copyToClipboard(reference);
                
                const originalText = this.innerHTML;
                this.innerHTML = '<i class="fas fa-check"></i> Copied!';
                this.style.background = 'rgba(40, 167, 69, 0.3)';
                
                setTimeout(() => {
                    this.innerHTML = originalText;
                    this.style.background = '';
                }, 2000);
            });
        }
        
        // Generate dynamic reference for bank transfer
        function generateBankReference() {
            const dynamicRef = Math.floor(1000 + Math.random() * 9000);
            document.getElementById('dynamicReference').textContent = dynamicRef;
            document.getElementById('orderId').textContent = dynamicRef;
        }
        
        // Copy to clipboard utility function
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                console.log('Copied to clipboard:', text);
            }).catch(err => {
                console.error('Failed to copy:', err);
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
            });
        }
        
        // Flagship product "See More" functionality
        function initializeFlagshipProduct() {
            const seeMoreBtn = document.querySelector('.see-more-btn');
            const flagshipDetails = document.querySelector('.flagship-details');
            
            if (seeMoreBtn && flagshipDetails) {
                const isMobile = window.innerWidth <= 850;
                if (isMobile) {
                    flagshipDetails.classList.add('collapsed');
                    flagshipDetails.classList.remove('expanded');
                    seeMoreBtn.innerHTML = '<i class="fas fa-chevron-down"></i> See More';
                } else {
                    flagshipDetails.classList.add('expanded');
                    flagshipDetails.classList.remove('collapsed');
                    seeMoreBtn.innerHTML = '<i class="fas fa-chevron-up"></i> See Less';
                }
                
                seeMoreBtn.addEventListener('click', () => {
                    const isCollapsed = flagshipDetails.classList.contains('collapsed');
                    
                    if (isCollapsed) {
                        flagshipDetails.classList.remove('collapsed');
                        flagshipDetails.classList.add('expanded');
                        seeMoreBtn.innerHTML = '<i class="fas fa-chevron-up"></i> See Less';
                    } else {
                        flagshipDetails.classList.remove('expanded');
                        flagshipDetails.classList.add('collapsed');
                        seeMoreBtn.innerHTML = '<i class="fas fa-chevron-down"></i> See More';
                    }
                });
                
                window.addEventListener('resize', () => {
                    const isMobile = window.innerWidth <= 850;
                    
                    if (isMobile && flagshipDetails.classList.contains('expanded')) {
                        flagshipDetails.classList.remove('expanded');
                        flagshipDetails.classList.add('collapsed');
                        seeMoreBtn.innerHTML = '<i class="fas fa-chevron-down"></i> See More';
                    }
                });
            }
        }
        
        // Function to display top searched products in overlay
        function displayTopSearchedProductsInOverlay() {
            let resultsHTML = `
                <div class="top-searched-section">
                    <h5><i class="fas fa-fire"></i> Top Searched Products</h5>
                    <div class="top-searched-products">
            `;
            
            // Get top 10 products by search score or sales
            const topProducts = [...allProducts]
                .sort((a, b) => (b.search_score || 0) - (a.search_score || 0))
                .slice(0, 10);
            
            topProducts.forEach(product => {
                resultsHTML += `
                    <div class="top-searched-item" data-id="${product.id}">
                        <img src="${product.image_url}" alt="${product.name}">
                        <div class="top-searched-info">
                            <h6>${product.name}</h6>
                            <div class="top-searched-price">R${parseFloat(product.price).toFixed(2)}</div>
                        </div>
                    </div>
                `;
            });
            
            resultsHTML += `
                    </div>
                </div>
                
                <div class="search-suggestions">
                    <h5><i class="fas fa-lightbulb"></i> Search by Skin Concern</h5>
                    <div class="suggestions-grid">
            `;
            
            const skinIssues = ['acne', 'dark spots', 'dry skin', 'oily skin', 'aging skin', 'hyperpigmentation', 'uneven skin tone'];
            skinIssues.forEach(issue => {
                resultsHTML += `<span class="suggestion-tag" data-suggestion="${issue}">${issue}</span>`;
            });
            
            resultsHTML += `
                    </div>
                </div>
                
                <div class="search-suggestions">
                    <h5><i class="fas fa-star"></i> Search by Benefits</h5>
                    <div class="suggestions-grid">
            `;
            
            const benefits = ['brightening', 'moisturizing', 'anti-aging', 'hydration', 'glowing skin', 'radiance'];
            benefits.forEach(benefit => {
                resultsHTML += `<span class="suggestion-tag" data-suggestion="${benefit}">${benefit}</span>`;
            });
            
            resultsHTML += `
                        </div>
                    </div>
                `;
            
            searchOverlayResults.innerHTML = resultsHTML;
            
            document.querySelectorAll('.top-searched-item').forEach(item => {
                item.addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-id'));
                    const product = allProducts.find(p => p.id === productId);
                    
                    if (product) {
                        navigateToProduct(product);
                        searchOverlay.classList.remove('active');
                        document.body.style.overflow = '';
                    }
                });
            });
            
            document.querySelectorAll('.suggestion-tag').forEach(tag => {
                tag.addEventListener('click', function() {
                    const suggestion = this.getAttribute('data-suggestion');
                    searchOverlayInput.value = suggestion;
                    performSearch(suggestion, searchOverlayResults);
                });
            });
        }
        
        // Function to display top searched products in desktop
        function displayTopSearchedProducts() {
            let resultsHTML = `
                <div class="top-searched-section">
                    <h5><i class="fas fa-fire"></i> Top Searched Products</h5>
                    <div class="top-searched-products">
            `;
            
            // Get top 10 products by search score or sales
            const topProducts = [...allProducts]
                .sort((a, b) => (b.search_score || 0) - (a.search_score || 0))
                .slice(0, 10);
            
            topProducts.forEach(product => {
                resultsHTML += `
                    <div class="top-searched-item" data-id="${product.id}">
                        <img src="${product.image_url}" alt="${product.name}">
                        <div class="top-searched-info">
                            <h6>${product.name}</h6>
                            <div class="top-searched-price">R${parseFloat(product.price).toFixed(2)}</div>
                        </div>
                    </div>
                `;
            });
            
            resultsHTML += `
                    </div>
                </div>
                
                <div class="search-suggestions">
                    <h5><i class="fas fa-lightbulb"></i> Search by Skin Concern</h5>
                    <div class="suggestions-grid">
            `;
            
            const skinIssues = ['acne', 'dark spots', 'dry skin', 'oily skin', 'aging skin', 'hyperpigmentation', 'uneven skin tone'];
            skinIssues.forEach(issue => {
                resultsHTML += `<span class="suggestion-tag" data-suggestion="${issue}">${issue}</span>`;
            });
            
            resultsHTML += `
                    </div>
                </div>
                
                <div class="search-suggestions">
                    <h5><i class="fas fa-star"></i> Search by Benefits</h5>
                    <div class="suggestions-grid">
            `;
            
            const benefits = ['brightening', 'moisturizing', 'anti-aging', 'hydration', 'glowing skin', 'radiance'];
            benefits.forEach(benefit => {
                resultsHTML += `<span class="suggestion-tag" data-suggestion="${benefit}">${benefit}</span>`;
            });
            
            resultsHTML += `
                    </div>
                </div>
            `;
            
            searchResults.innerHTML = resultsHTML;
            searchResults.classList.add('active');
            
            document.querySelectorAll('.top-searched-item').forEach(item => {
                item.addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-id'));
                    const product = allProducts.find(p => p.id === productId);
                    
                    if (product) {
                        navigateToProduct(product);
                    }
                });
            });
            
            document.querySelectorAll('.suggestion-tag').forEach(tag => {
                tag.addEventListener('click', function() {
                    const suggestion = this.getAttribute('data-suggestion');
                    searchInput.value = suggestion;
                    performSearch(suggestion, searchResults);
                });
            });
        }
        
        // Function to perform search with predictive suggestions
        function performSearch(searchTerm, resultsContainer) {
            const filteredProducts = [];
            const suggestions = new Set();
            
            allProducts.forEach(product => {
                let score = 0;
                let matchedFields = [];
                
                if (product.name.toLowerCase().includes(searchTerm)) {
                    score += 30;
                    matchedFields.push('name');
                }
                
                if (product.description.toLowerCase().includes(searchTerm)) {
                    score += 20;
                    matchedFields.push('description');
                }
                
                if (product.benefits && product.benefits.toLowerCase().includes(searchTerm)) {
                    score += 15;
                    matchedFields.push('benefits');
                }
                
                if (product.tags) {
                    const tags = product.tags.split(',').map(tag => tag.trim().toLowerCase());
                    tags.forEach(tag => {
                        if (tag.includes(searchTerm)) {
                            score += 10;
                            matchedFields.push('tag: ' + tag);
                            
                            // Add to suggestions
                            if (tag !== searchTerm) {
                                suggestions.add(tag);
                            }
                        }
                    });
                }
                
                if (product.category.toLowerCase().includes(searchTerm)) {
                    score += 5;
                    matchedFields.push('category');
                }
                
                if (score > 0) {
                    filteredProducts.push({
                        product: product,
                        score: score + (product.search_score || 50),
                        matchedFields: matchedFields
                    });
                }
            });
            
            filteredProducts.sort((a, b) => b.score - a.score);
            
            const suggestionArray = Array.from(suggestions).slice(0, 5);
            
            displaySearchResults(filteredProducts, suggestionArray, searchTerm, resultsContainer);
        }
        
        // Function to display search results with suggestions
        function displaySearchResults(filteredProducts, suggestions, searchTerm, resultsContainer) {
            if (filteredProducts.length === 0 && suggestions.length === 0) {
                resultsContainer.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search" style="font-size: 40px; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>No products found for "${searchTerm}"</p>
                        <p style="margin-top: 10px; font-size: 14px;">Try searching for: acne, dark spots, brightening, moisturizing, oud, perfume</p>
                    </div>
                `;
                
                if (resultsContainer === searchResults) {
                    searchResults.classList.add('active');
                }
                return;
            }
            
            let resultsHTML = '';
            
            if (suggestions.length > 0) {
                resultsHTML += `
                    <div class="search-suggestions">
                        <h5><i class="fas fa-lightbulb"></i> Try Searching For</h5>
                        <div class="suggestions-grid">
                `;
                
                suggestions.forEach(suggestion => {
                    resultsHTML += `<span class="suggestion-tag" data-suggestion="${suggestion}">${suggestion}</span>`;
                });
                
                resultsHTML += `
                        </div>
                    </div>
                `;
            }
            
            if (filteredProducts.length > 0) {
                resultsHTML += `
                    <div class="search-results-list">
                        <h5><i class="fas fa-check-circle"></i> ${filteredProducts.length} Products Found</h5>
                `;
                
                filteredProducts.forEach((item, index) => {
                    const product = item.product;
                    const matchedFields = item.matchedFields.slice(0, 2).join(', ');
                    
                    resultsHTML += `
                        <div class="search-result-item" data-id="${product.id}">
                            <img src="${product.image_url}" alt="${product.name}">
                            <div class="search-result-info">
                                <h4>${product.name}</h4>
                                <p>${product.description.substring(0, 60)}...</p>
                                <div class="search-result-tags">
                                    <span class="search-result-tag">${product.category}</span>
                                    ${item.score > 100 ? '<span class="search-result-tag" style="background: rgba(255,193,7,0.2);">Popular</span>' : ''}
                                    ${product.category === 'perfume' ? '<span class="search-result-tag" style="background: rgba(196,167,125,0.2);">Amal Fragrances</span>' : ''}
                                </div>
                                <div class="search-result-price">R${parseFloat(product.price).toFixed(2)}</div>
                            </div>
                        </div>
                    `;
                });
                
                resultsHTML += `</div>`;
            }
            
            resultsContainer.innerHTML = resultsHTML;
            
            if (resultsContainer === searchResults) {
                searchResults.classList.add('active');
            }
            
            resultsContainer.querySelectorAll('.search-result-item').forEach(item => {
                item.addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-id'));
                    const product = allProducts.find(p => p.id === productId);
                    
                    if (product) {
                        navigateToProduct(product);
                        
                        if (searchOverlay.classList.contains('active')) {
                            searchOverlay.classList.remove('active');
                            document.body.style.overflow = '';
                        }
                    }
                });
            });
            
            resultsContainer.querySelectorAll('.suggestion-tag').forEach(tag => {
                tag.addEventListener('click', function() {
                    const suggestion = this.getAttribute('data-suggestion');
                    
                    if (resultsContainer === searchOverlayResults) {
                        searchOverlayInput.value = suggestion;
                        performSearch(suggestion, searchOverlayResults);
                    } else {
                        searchInput.value = suggestion;
                        performSearch(suggestion, searchResults);
                    }
                });
            });
        }
        
        // Function to navigate to product and highlight it
        function navigateToProduct(product) {
            searchInput.classList.remove('active');
            searchClose.classList.remove('active');
            searchInput.value = '';
            searchResults.classList.remove('active');
            
            let targetSectionId;
            if (product.section === "products") {
                targetSectionId = "products";
            } else if (product.section === "flagship") {
                targetSectionId = "flagship";
            } else {
                targetSectionId = "all-products";
            }
            
            document.getElementById(targetSectionId).scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
            
            setTimeout(() => {
                const productElement = document.querySelector(`.add-to-cart[data-id="${product.id}"]`);
                if (productElement) {
                    const productCard = productElement.closest('.product-card');
                    
                    productCard.scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'center'
                    });
                    
                    productCard.style.animation = 'none';
                    void productCard.offsetWidth;
                    productCard.style.animation = 'pulse 2s';
                    
                    productCard.style.boxShadow = '0 0 0 3px var(--accent-color)';
                    productCard.style.transform = 'scale(1.02)';
                    
                    setTimeout(() => {
                        productCard.style.boxShadow = '';
                        productCard.style.transform = '';
                    }, 3000);
                }
            }, 800);
        }
        
        // Close search when clicking outside (desktop only)
        document.addEventListener('click', (e) => {
            if (window.innerWidth > 768) {
                if (!searchInput.contains(e.target) && !searchIcon.contains(e.target) && !searchResults.contains(e.target)) {
                    searchInput.classList.remove('active');
                    searchClose.classList.remove('active');
                    searchResults.classList.remove('active');
                }
            }
        });
        
        // NEW: Address Selection Functions with manual entry support
        
        function initializeAddressSelection() {
            populateCountryOptions();
            
            document.getElementById('nextAddressStep').addEventListener('click', goToNextAddressStep);
            document.getElementById('prevAddressStep').addEventListener('click', goToPrevAddressStep);
            
            document.getElementById('shippingZip').addEventListener('input', validateZipCode);
        }
        
        function populateCountryOptions() {
            const countryOptions = document.getElementById('countryOptions');
            countryOptions.innerHTML = '';
            
            addressData.countries.forEach(country => {
                const option = document.createElement('div');
                option.className = 'address-option';
                option.innerHTML = `
                    <i class="fas fa-globe-americas"></i>
                    <p>${country.flag} ${country.name}</p>
                    <small style="color: rgba(255, 255, 255, 0.6);">${country.currency}</small>
                `;
                option.addEventListener('click', () => selectCountry(country.code));
                countryOptions.appendChild(option);
            });
        }
        
        function selectCountry(countryCode) {
            selectedCountry = countryCode;
            const country = addressData.countries.find(c => c.code === countryCode);
            
            document.querySelectorAll('#countryOptions .address-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.target.closest('.address-option').classList.add('selected');
            
            updateAddressProgress('country');
            
            populateStateOptions(countryCode);
            
            setTimeout(() => goToNextAddressStep(), 500);
        }
        
        function populateStateOptions(countryCode) {
            const stateOptions = document.getElementById('stateOptions');
            stateOptions.innerHTML = '';
            
            const states = addressData.states[countryCode] || [];
            
            if (states.length === 0) {
                stateOptions.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: rgba(255, 255, 255, 0.7);">
                        <i class="fas fa-exclamation-circle" style="font-size: 40px; margin-bottom: 15px;"></i>
                        <p>No states/provinces available for this country.</p>
                        <p style="margin-top: 10px; font-size: 14px;">You can enter state manually.</p>
                    </div>
                `;
                return;
            }
            
            states.forEach(state => {
                const option = document.createElement('div');
                option.className = 'address-option';
                option.innerHTML = `
                    <i class="fas fa-map-marker-alt"></i>
                    <p>${state}</p>
                `;
                option.addEventListener('click', () => selectState(state));
                stateOptions.appendChild(option);
            });
        }
        
        function selectState(state) {
            selectedState = state;
            manualState = '';
            isManualEntry = false;
            
            document.querySelectorAll('#stateOptions .address-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.target.closest('.address-option').classList.add('selected');
            
            updateAddressProgress('state');
            
            populateCityOptions(state);
            
            setTimeout(() => goToNextAddressStep(), 500);
        }
        
        function enterStateManually() {
            isManualEntry = true;
            selectedState = '';
            manualState = prompt('Please enter your state/province name:');
            
            if (manualState && manualState.trim()) {
                manualState = manualState.trim();
                selectedState = manualState;
                updateAddressProgress('state');
                
                populateCityOptions(manualState);
                
                setTimeout(() => goToNextAddressStep(), 500);
            }
        }
        
        function populateCityOptions(state) {
            const cityOptions = document.getElementById('cityOptions');
            cityOptions.innerHTML = '';
            
            const cities = addressData.cities[state] || [];
            
            if (cities.length === 0) {
                cityOptions.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: rgba(255, 255, 255, 0.7);">
                        <i class="fas fa-exclamation-circle" style="font-size: 40px; margin-bottom: 15px;"></i>
                        <p>No cities available for this state.</p>
                        <p style="margin-top: 10px; font-size: 14px;">You can enter city manually.</p>
                    </div>
                `;
                return;
            }
            
            cities.forEach(city => {
                const option = document.createElement('div');
                option.className = 'address-option';
                option.innerHTML = `
                    <i class="fas fa-city"></i>
                    <p>${city}</p>
                `;
                option.addEventListener('click', () => selectCity(city));
                cityOptions.appendChild(option);
            });
        }
        
        function selectCity(city) {
            selectedCity = city;
            manualCity = '';
            isManualEntry = false;
            
            document.querySelectorAll('#cityOptions .address-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.target.closest('.address-option').classList.add('selected');
            
            updateAddressProgress('city');
            
            populateVillageOptions(city);
            
            setTimeout(() => goToNextAddressStep(), 500);
        }
        
        function enterCityManually() {
            isManualEntry = true;
            selectedCity = '';
            manualCity = prompt('Please enter your city/town name:');
            
            if (manualCity && manualCity.trim()) {
                manualCity = manualCity.trim();
                selectedCity = manualCity;
                updateAddressProgress('city');
                
                populateVillageOptions(manualCity);
                
                setTimeout(() => goToNextAddressStep(), 500);
            }
        }
        
        function populateVillageOptions(city) {
            const villageOptions = document.getElementById('villageOptions');
            villageOptions.innerHTML = '';
            
            const villages = addressData.villages[city] || [];
            
            if (villages.length === 0) {
                villageOptions.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: rgba(255, 255, 255, 0.7);">
                        <i class="fas fa-exclamation-circle" style="font-size: 40px; margin-bottom: 15px;"></i>
                        <p>No villages/suburbs available for this city.</p>
                        <p style="margin-top: 10px; font-size: 14px;">You can enter village manually below.</p>
                    </div>
                `;
                return;
            }
            
            villages.forEach(village => {
                const option = document.createElement('div');
                option.className = 'address-option';
                option.innerHTML = `
                    <i class="fas fa-home"></i>
                    <p>${village}</p>
                `;
                option.addEventListener('click', () => selectVillage(village));
                villageOptions.appendChild(option);
            });
        }
        
        function selectVillage(village) {
            selectedVillage = village;
            manualVillage = '';
            manualZip = '';
            isManualEntry = false;
            
            document.querySelectorAll('#villageOptions .address-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.target.closest('.address-option').classList.add('selected');
            
            updateAddressProgress('village');
            
            // Clear manual village input if shown
            document.getElementById('manualVillageContainer').classList.remove('active');
            document.getElementById('manualVillageName').value = '';
            document.getElementById('manualVillageZip').value = '';
            
            setTimeout(() => goToNextAddressStep(), 500);
        }
        
        function enterVillageManually() {
            // Hide village options and show manual input
            document.getElementById('villageOptions').style.display = 'none';
            document.getElementById('villageSearch').style.display = 'none';
            document.getElementById('manualVillageContainer').classList.add('active');
            document.querySelectorAll('#villageStep .address-option').forEach(opt => {
                opt.style.display = 'none';
            });
        }
        
        function cancelManualVillage() {
            // Show village options and hide manual input
            document.getElementById('villageOptions').style.display = 'block';
            document.getElementById('villageSearch').style.display = 'flex';
            document.getElementById('manualVillageContainer').classList.remove('active');
            document.querySelectorAll('#villageStep .address-option').forEach(opt => {
                opt.style.display = 'flex';
            });
            
            // Clear manual input
            document.getElementById('manualVillageName').value = '';
            document.getElementById('manualVillageZip').value = '';
        }
        
        function saveManualVillage() {
            const villageName = document.getElementById('manualVillageName').value.trim();
            const villageZip = document.getElementById('manualVillageZip').value.trim();
            
            if (!villageName) {
                alert('Please enter village/suburb name');
                return;
            }
            
            if (!villageZip) {
                alert('Please enter ZIP/postal code');
                return;
            }
            
            // Set manual values
            manualVillage = villageName;
            manualZip = villageZip;
            selectedVillage = villageName;
            selectedZip = villageZip;
            isManualEntry = true;
            
            // Show manual village note in ZIP step
            document.getElementById('manualVillageNote').style.display = 'block';
            
            updateAddressProgress('village');
            
            // Go to ZIP step directly since we already have ZIP
            document.getElementById('villageStep').classList.remove('active');
            currentAddressStep = 'zip';
            document.getElementById('zipStep').classList.add('active');
            
            // Set the ZIP input value
            document.getElementById('shippingZip').value = villageZip;
            
            // Update address confirmation
            updateAddressConfirmation();
            
            // Update navigation
            updateAddressNavigation();
            
            // Validate ZIP
            validateZipCode();
        }
        
        function skipVillage() {
            selectedVillage = '';
            manualVillage = '';
            manualZip = '';
            isManualEntry = false;
            
            updateAddressProgress('village');
            
            goToNextAddressStep();
        }
        
        function validateZipCode() {
            const zipInput = document.getElementById('shippingZip');
            const zipValidation = document.getElementById('zipValidation');
            selectedZip = zipInput.value.trim();
            
            if (!selectedZip) {
                zipValidation.innerHTML = '';
                return false;
            }
            
            // If manual entry, accept any ZIP code
            if (isManualEntry && manualZip) {
                zipValidation.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <span>Manual ZIP code accepted</span>
                `;
                zipValidation.className = 'zip-validation valid';
                
                updateAddressConfirmation();
                return true;
            }
            
            // For regular entries, validate against list if available
            const validZips = addressData.zipCodes[selectedCity] || [];
            const isValid = validZips.some(zip => selectedZip.startsWith(zip.substring(0, 2))) || validZips.length === 0;
            
            if (isValid) {
                zipValidation.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <span>Valid ZIP code for ${selectedCity}</span>
                `;
                zipValidation.className = 'zip-validation valid';
                
                updateAddressConfirmation();
                return true;
            } else {
                zipValidation.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>ZIP code may not match ${selectedCity}</span>
                `;
                zipValidation.className = 'zip-validation invalid';
                return false;
            }
        }
        
        function updateAddressConfirmation() {
            const addressDetails = document.getElementById('addressDetails');
            const addressConfirmation = document.getElementById('addressConfirmation');
            
            if ((selectedCountry && selectedState && selectedCity) || (selectedCountry && (manualState || manualCity))) {
                let addressText = '';
                
                if (isManualEntry) {
                    addressText = `
                        <strong>${manualVillage || 'N/A'}</strong><br>
                        ${manualCity || selectedCity}, ${manualState || selectedState}<br>
                        ${selectedCountry}<br>
                        ZIP: ${manualZip || selectedZip}<br>
                        <small style="color: var(--accent-color);"><i class="fas fa-edit"></i> Manually entered</small>
                    `;
                } else {
                    addressText = `
                        <strong>${selectedVillage || 'N/A'}, ${selectedCity}</strong><br>
                        ${selectedState}, ${selectedCountry}<br>
                        ZIP: ${selectedZip}
                    `;
                }
                
                addressDetails.innerHTML = addressText;
                addressConfirmation.style.display = 'block';
            } else {
                addressConfirmation.style.display = 'none';
            }
        }
        
        function updateAddressProgress(step) {
            document.querySelectorAll('.address-progress-step').forEach(stepEl => {
                stepEl.classList.remove('active', 'completed');
                
                const stepName = stepEl.getAttribute('data-step');
                
                if (stepName === step) {
                    stepEl.classList.add('active');
                } else if (
                    (stepName === 'country' && selectedCountry) ||
                    (stepName === 'state' && (selectedState || manualState)) ||
                    (stepName === 'city' && (selectedCity || manualCity)) ||
                    (stepName === 'village' && (selectedVillage !== undefined || manualVillage)) ||
                    (stepName === 'zip' && (selectedZip || manualZip))
                ) {
                    stepEl.classList.add('completed');
                }
            });
            
            updateAddressConfirmation();
        }
        
        function goToNextAddressStep() {
            const steps = ['country', 'state', 'city', 'village', 'zip'];
            const currentIndex = steps.indexOf(currentAddressStep);
            
            if (!validateCurrentAddressStep()) {
                return;
            }
            
            if (currentIndex < steps.length - 1) {
                document.getElementById(`${currentAddressStep}Step`).classList.remove('active');
                
                currentAddressStep = steps[currentIndex + 1];
                
                document.getElementById(`${currentAddressStep}Step`).classList.add('active');
                
                updateAddressNavigation();
                
                updateAddressProgress(currentAddressStep);
                
                if (currentAddressStep === 'zip') {
                    validateZipCode();
                }
            }
        }
        
        function goToPrevAddressStep() {
            const steps = ['country', 'state', 'city', 'village', 'zip'];
            const currentIndex = steps.indexOf(currentAddressStep);
            
            if (currentIndex > 0) {
                document.getElementById(`${currentAddressStep}Step`).classList.remove('active');
                
                currentAddressStep = steps[currentIndex - 1];
                
                document.getElementById(`${currentAddressStep}Step`).classList.add('active');
                
                updateAddressNavigation();
                
                // Reset manual village display if going back to village step
                if (currentAddressStep === 'village') {
                    document.getElementById('villageOptions').style.display = 'block';
                    document.getElementById('villageSearch').style.display = 'flex';
                    document.getElementById('manualVillageContainer').classList.remove('active');
                    document.querySelectorAll('#villageStep .address-option').forEach(opt => {
                        opt.style.display = 'flex';
                    });
                }
            }
        }
        
        function updateAddressNavigation() {
            const prevBtn = document.getElementById('prevAddressStep');
            const nextBtn = document.getElementById('nextAddressStep');
            
            if (currentAddressStep === 'country') {
                prevBtn.style.display = 'none';
            } else {
                prevBtn.style.display = 'inline-flex';
            }
            
            if (currentAddressStep === 'zip') {
                nextBtn.innerHTML = 'Complete Address Selection <i class="fas fa-check"></i>';
            } else {
                nextBtn.innerHTML = 'Next <i class="fas fa-arrow-right"></i>';
            }
        }
        
        function validateCurrentAddressStep() {
            switch (currentAddressStep) {
                case 'country':
                    if (!selectedCountry) {
                        alert('Please select a country');
                        return false;
                    }
                    break;
                case 'state':
                    if (!selectedState && !manualState) {
                        alert('Please select or enter a state/province');
                        return false;
                    }
                    break;
                case 'city':
                    if (!selectedCity && !manualCity) {
                        alert('Please select or enter a city/town');
                        return false;
                    }
                    break;
                case 'village':
                    // Village is optional
                    break;
                case 'zip':
                    if (!validateZipCode()) {
                        alert('Please enter a valid ZIP code');
                        return false;
                    }
                    break;
            }
            return true;
        }
        
        function validateAddressSelection() {
            // For manual entry, we need at least country, state (manual), city (manual), and zip
            if (isManualEntry) {
                return selectedCountry && (manualState || selectedState) && (manualCity || selectedCity) && (manualZip || selectedZip);
            }
            
            // For regular entry, we need country, state, city, and zip
            return selectedCountry && selectedState && selectedCity && selectedZip;
        }
        
        function resetAddressSelection() {
            currentAddressStep = 'country';
            selectedCountry = '';
            selectedState = '';
            selectedCity = '';
            selectedVillage = '';
            selectedZip = '';
            isManualEntry = false;
            manualState = '';
            manualCity = '';
            manualVillage = '';
            manualZip = '';
            
            document.querySelectorAll('.address-step').forEach(step => {
                step.classList.remove('active');
            });
            document.getElementById('countryStep').classList.add('active');
            
            document.querySelectorAll('.address-progress-step').forEach(step => {
                step.classList.remove('active', 'completed');
            });
            document.querySelector('[data-step="country"]').classList.add('active');
            
            document.querySelectorAll('.address-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Reset manual village container
            document.getElementById('villageOptions').style.display = 'block';
            document.getElementById('villageSearch').style.display = 'flex';
            document.getElementById('manualVillageContainer').classList.remove('active');
            document.getElementById('manualVillageName').value = '';
            document.getElementById('manualVillageZip').value = '';
            document.querySelectorAll('#villageStep .address-option').forEach(opt => {
                opt.style.display = 'flex';
            });
            
            document.getElementById('shippingZip').value = '';
            document.getElementById('zipValidation').innerHTML = '';
            document.getElementById('addressConfirmation').style.display = 'none';
            document.getElementById('manualVillageNote').style.display = 'none';
            
            updateAddressNavigation();
        }
        
        // Search functions for address selection
        function searchStates() {
            const searchTerm = document.getElementById('stateSearch').value.toLowerCase();
            const states = addressData.states[selectedCountry] || [];
            const filteredStates = states.filter(state => 
                state.toLowerCase().includes(searchTerm)
            );
            
            const stateOptions = document.getElementById('stateOptions');
            stateOptions.innerHTML = '';
            
            if (filteredStates.length === 0) {
                stateOptions.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: rgba(255, 255, 255, 0.7);">
                        <i class="fas fa-search" style="font-size: 40px; margin-bottom: 15px;"></i>
                        <p>No states found for "${searchTerm}"</p>
                    </div>
                `;
                return;
            }
            
            filteredStates.forEach(state => {
                const option = document.createElement('div');
                option.className = 'address-option';
                option.innerHTML = `
                    <i class="fas fa-map-marker-alt"></i>
                    <p>${state}</p>
                `;
                option.addEventListener('click', () => selectState(state));
                stateOptions.appendChild(option);
            });
        }
        
        function searchCities() {
            const searchTerm = document.getElementById('citySearch').value.toLowerCase();
            const stateName = selectedState || manualState;
            const cities = addressData.cities[stateName] || [];
            const filteredCities = cities.filter(city => 
                city.toLowerCase().includes(searchTerm)
            );
            
            const cityOptions = document.getElementById('cityOptions');
            cityOptions.innerHTML = '';
            
            if (filteredCities.length === 0) {
                cityOptions.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: rgba(255, 255, 255, 0.7);">
                        <i class="fas fa-search" style="font-size: 40px; margin-bottom: 15px;"></i>
                        <p>No cities found for "${searchTerm}"</p>
                    </div>
                `;
                return;
            }
            
            filteredCities.forEach(city => {
                const option = document.createElement('div');
                option.className = 'address-option';
                option.innerHTML = `
                    <i class="fas fa-city"></i>
                    <p>${city}</p>
                `;
                option.addEventListener('click', () => selectCity(city));
                cityOptions.appendChild(option);
            });
        }
        
        function searchVillages() {
            const searchTerm = document.getElementById('villageSearch').value.toLowerCase();
            const cityName = selectedCity || manualCity;
            const villages = addressData.villages[cityName] || [];
            const filteredVillages = villages.filter(village => 
                village.toLowerCase().includes(searchTerm)
            );
            
            const villageOptions = document.getElementById('villageOptions');
            villageOptions.innerHTML = '';
            
            if (filteredVillages.length === 0) {
                villageOptions.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: rgba(255, 255, 255, 0.7);">
                        <i class="fas fa-search" style="font-size: 40px; margin-bottom: 15px;"></i>
                        <p>No villages found for "${searchTerm}"</p>
                    </div>
                `;
                return;
            }
            
            filteredVillages.forEach(village => {
                const option = document.createElement('div');
                option.className = 'address-option';
                option.innerHTML = `
                    <i class="fas fa-home"></i>
                    <p>${village}</p>
                `;
                option.addEventListener('click', () => selectVillage(village));
                villageOptions.appendChild(option);
            });
        }
    </script>
</body>
</html>